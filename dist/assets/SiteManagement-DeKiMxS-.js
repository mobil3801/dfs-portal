import{j as e}from"./radix-ui-woSLwCdF.js";import{r as s}from"./react-core-CKNU0hQt.js";import{l as a,D as t,a as i,b as n,c as r,L as l,I as c,e as d,v as o,C as m,h as x,f as h,g,B as j}from"./index-DyvxZZaK.js";import{S as p}from"./switch-B83LJYhb.js";import{T as u}from"./textarea-DRHimfhP.js";import{u as v,B as N,C as b,a as w}from"./BatchDeleteDialog-B0aLDkDP.js";import{u as y}from"./use-station-store-DDC1HmYO.js";import{B as f}from"./BatchEditDialog-BmGSI7Fd.js";import{S,c as _,d as C,a as F,b as M}from"./select-DxfsAJPc.js";import{ak as A,T as D,X as k,Q as E,C as T,S as L,R as O,aw as R,v as I,g as q,W as P,Z as z,V as $,ag as B,a7 as U,n as G,aE as V,I as H}from"./utilities-DMEd7dY0.js";import{A as K}from"./AccessDenied-CMgfgpRV.js";import"./routing-DcURAnU1.js";import"./data-management-r38r-ocq.js";import"./animations-CdlE0-Ca.js";const Q=({open:o,onOpenChange:m,station:x,onSave:h,mode:g})=>{const{toast:j}=a(),{addStation:p,updateStation:v,stations:N}=y(),[b,w]=s.useState(!1),[f,L]=s.useState({}),[O,R]=s.useState({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"});s.useEffect(()=>{x&&"edit"===g?R({id:x.id,station_name:x.station_name||"",address:x.address||"",phone:x.phone||"",operating_hours:x.operating_hours||"",manager_name:x.manager_name||"",status:x.status||"Active"}):"add"===g&&R({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"}),L({})},[x,g,o]);const I=()=>{b||m(!1)};return e.jsx(t,{open:o,onOpenChange:I,children:e.jsxs(i,{className:"sm:max-w-md",children:[e.jsx(n,{children:e.jsxs(r,{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"add"===g?"Add New Station":"Edit Station"})]})}),e.jsxs("form",{onSubmit:async s=>{s.preventDefault(),w(!0),L({});try{const s={};if(O.station_name.trim()?O.station_name.trim().length<2&&(s.station_name="Station name must be at least 2 characters"):s.station_name="Station name is required",O.address.trim()||(s.address="Address is required"),O.phone.trim()?/^[\+]?[\d\s\-\(\)]{10,}$/.test(O.phone.trim())||(s.phone="Please enter a valid phone number"):s.phone="Phone number is required",O.operating_hours.trim()||(s.operating_hours="Operating hours are required"),O.manager_name.trim()||(s.manager_name="Manager name is required"),"add"===g){N.find(e=>e.name?.toLowerCase()===O.station_name.trim().toLowerCase()||e.station_name?.toLowerCase()===O.station_name.trim().toLowerCase())&&(s.station_name=`Station "${O.station_name}" already exists`)}if(Object.keys(s).length>0)return L(s),void j({title:"Validation Error",description:"Please fix the errors below",variant:"destructive"});const a={name:O.station_name.trim(),station_name:O.station_name.trim(),address:O.address.trim(),phone:O.phone.trim(),operating_hours:O.operating_hours.trim(),manager_name:O.manager_name.trim(),status:O.status,active:"Active"===O.status,notes:O.operating_hours.trim(),station_id:"add"===g?O.station_name.trim().toLowerCase().replace(/\s+/g,"-"):x?.station_id||O.station_name.trim().toLowerCase().replace(/\s+/g,"-")};let t;t="add"===g?await p(a):await v({...a,id:x?.id||"",created_at:x?.created_at,updated_at:(new Date).toISOString()}),t.success&&(h(),m(!1),j({title:"Success!",description:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{children:['Station "',O.station_name,'" ',"add"===g?"created":"updated","and is now available in all station dropdowns"]})]})}))}catch(a){console.error("Error saving station:",a),j({title:"Error",description:"string"==typeof a?a:"Failed to save station",variant:"destructive"})}finally{w(!1)}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"station_name",children:"Station Name *"}),e.jsx(c,{id:"station_name",value:O.station_name,onChange:e=>R({...O,station_name:e.target.value}),placeholder:"e.g., MOBIL, AMOCO ROSEDALE",required:!0,className:f.station_name?"border-red-500":""}),f.station_name&&e.jsxs("p",{className:"text-xs text-red-500 mt-1 flex items-center space-x-1",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("span",{children:f.station_name})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"address",children:"Address *"}),e.jsx(u,{id:"address",value:O.address,onChange:e=>R({...O,address:e.target.value}),placeholder:"Complete station address",required:!0,rows:2,className:f.address?"border-red-500":""}),f.address&&e.jsxs("p",{className:"text-xs text-red-500 mt-1 flex items-center space-x-1",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("span",{children:f.address})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(c,{id:"phone",type:"tel",value:O.phone,onChange:e=>R({...O,phone:e.target.value}),placeholder:"(555) 123-4567",required:!0,className:f.phone?"border-red-500":""}),f.phone&&e.jsxs("p",{className:"text-xs text-red-500 mt-1 flex items-center space-x-1",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("span",{children:f.phone})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"operating_hours",children:"Operating Hours *"}),e.jsx(c,{id:"operating_hours",value:O.operating_hours,onChange:e=>R({...O,operating_hours:e.target.value}),placeholder:"e.g., 24/7 or 6:00 AM - 12:00 AM",required:!0,className:f.operating_hours?"border-red-500":""}),f.operating_hours&&e.jsxs("p",{className:"text-xs text-red-500 mt-1 flex items-center space-x-1",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("span",{children:f.operating_hours})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"manager_name",children:"Manager Name *"}),e.jsx(c,{id:"manager_name",value:O.manager_name,onChange:e=>R({...O,manager_name:e.target.value}),placeholder:"Station manager name",required:!0,className:f.manager_name?"border-red-500":""}),f.manager_name&&e.jsxs("p",{className:"text-xs text-red-500 mt-1 flex items-center space-x-1",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("span",{children:f.manager_name})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(S,{value:O.status,onValueChange:e=>R({...O,status:e}),children:[e.jsx(_,{children:e.jsx(C,{placeholder:"Select status"})}),e.jsxs(F,{children:[e.jsx(M,{value:"Active",children:"Active"}),e.jsx(M,{value:"Inactive",children:"Inactive"}),e.jsx(M,{value:"Maintenance",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsxs(d,{type:"button",variant:"outline",onClick:I,disabled:b,children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(d,{type:"submit",disabled:b,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),b?"Saving...":"add"===g?"Add Station":"Update Station"]})]})]})]})})},Z=()=>{const{isAdmin:t}=o(),[i,n]=s.useState({siteName:"DFS Manager Portal",siteDescription:"Comprehensive gas station management system",enableRegistration:!1,enableNotifications:!0,enableMaintenance:!1,maintenanceMessage:"System is under maintenance. Please check back later.",emailFromAddress:"support@ezsite.ai",emailFromName:"DFS Manager Support",maxFileSize:10,allowedFileTypes:"jpg,jpeg,png,pdf,doc,docx,xls,xlsx",sessionTimeout:30,passwordMinLength:8,requirePasswordComplexity:!0,enableTwoFactor:!1,backupFrequency:"daily",logRetentionDays:30}),{stations:r,loading:S,deleteStation:_,updateStation:C}=y(),[F,M]=s.useState(null),[D,k]=s.useState(!1),[Z,W]=s.useState("add"),[X,Y]=s.useState(!1),[J,ee]=s.useState(!1),[se,ae]=s.useState(!1),[te,ie]=s.useState(!1),[ne,re]=s.useState(!1),{toast:le}=a(),ce=v(),[de,oe]=s.useState({status:"",manager_name:"",operating_hours:""}),me=e=>e?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Site Management"})]}),e.jsx(d,{onClick:async()=>{re(!0);try{await new Promise(e=>setTimeout(e,1e3)),le({title:"Success",description:"Site settings saved successfully"})}catch(e){console.error("Error saving settings:",e),le({title:"Error",description:"Failed to save settings",variant:"destructive"})}finally{re(!1)}},disabled:ne,className:"bg-blue-600 hover:bg-blue-700",children:ne?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(m,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(T,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"System Status"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:"Online"})]})]})})}),e.jsx(m,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Database"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:"Connected"})]})]})})}),e.jsx(m,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email Service"}),e.jsx("p",{className:"text-lg font-semibold text-purple-600",children:"Active"})]})]})})}),e.jsx(m,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Security"}),e.jsx("p",{className:"text-lg font-semibold text-orange-600",children:"Protected"})]})]})})})]}),e.jsx(N,{selectedCount:ce.selectedCount,onBatchEdit:()=>{0!==ce.getSelectedData(r,e=>e.id).length?Y(!0):le({title:"No Selection",description:"Please select stations to edit",variant:"destructive"})},onBatchDelete:()=>{0!==ce.getSelectedData(r,e=>e.id).length?ee(!0):le({title:"No Selection",description:"Please select stations to delete",variant:"destructive"})},onClearSelection:ce.clearSelection,isLoading:se}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"Station Information"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{onClick:()=>{M(null),W("add"),k(!0)},className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Add Station"]}),0===r.length&&e.jsxs(d,{onClick:()=>window.open("/dashboard?tab=setup","_blank"),variant:"outline",size:"sm",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Setup Guide"]}),r.length>0&&e.jsx(b,{checked:r.length>0&&ce.selectedCount===r.length,onCheckedChange:()=>ce.toggleSelectAll(r,e=>e.id),"aria-label":"Select all stations"})]})]})}),e.jsx(x,{children:S?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(s=>e.jsx(m,{className:"border animate-pulse",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})})},s))}):0===r.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No Stations Configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Set up your gas stations (MOBIL, AMOCO ROSEDALE, AMOCO BROOKLYN) to get started."}),e.jsxs(d,{onClick:()=>window.open("/dashboard?tab=setup","_blank"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Go to Setup Guide"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:r.map((s,a)=>e.jsx(m,{className:"border "+(ce.isSelected(s.id)?"bg-blue-50 border-blue-200":""),children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{checked:ce.isSelected(s.id),onCheckedChange:()=>ce.toggleItem(s.id),"aria-label":`Select station ${s.station_name}`}),e.jsx("h3",{className:"font-semibold text-lg",children:s.station_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{className:""+("Active"===s.status?"bg-green-100 text-green-800":"Inactive"===s.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:s.status}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>(e=>{M(e),W("edit"),k(!0)})(s),className:"h-8 w-8 p-0",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx(d,{size:"sm",variant:"outline",onClick:async()=>{if(window.confirm(`Are you sure you want to delete "${s.station_name}"?`)){const e=await _(s.id.toString());e.success||le({title:"Error",description:e.error||"Failed to delete station",variant:"destructive"})}},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx($,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(B,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.address})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.operating_hours})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Manager: ",s.manager_name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Updated: ",new Date(s.last_updated).toLocaleDateString()]})]})]})]})})},s.id||a))})})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"General Settings"})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"siteName",children:"Site Name"}),e.jsx(c,{id:"siteName",value:i.siteName,onChange:e=>n({...i,siteName:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"siteDescription",children:"Site Description"}),e.jsx(c,{id:"siteDescription",value:i.siteDescription,onChange:e=>n({...i,siteDescription:e.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"maintenanceMessage",children:"Maintenance Message"}),e.jsx(u,{id:"maintenanceMessage",value:i.maintenanceMessage,onChange:e=>n({...i,maintenanceMessage:e.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"User Registration"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow new user registration"})]}),e.jsx(p,{checked:i.enableRegistration,onCheckedChange:e=>n({...i,enableRegistration:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable system notifications"})]}),e.jsx(p,{checked:i.enableNotifications,onCheckedChange:e=>n({...i,enableNotifications:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Put site in maintenance"})]}),e.jsx(p,{checked:i.enableMaintenance,onCheckedChange:e=>n({...i,enableMaintenance:e})})]})]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:"Email Configuration"})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"emailFromName",children:"From Name"}),e.jsx(c,{id:"emailFromName",value:i.emailFromName,onChange:e=>n({...i,emailFromName:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"emailFromAddress",children:"From Address"}),e.jsx(c,{id:"emailFromAddress",type:"email",value:i.emailFromAddress,onChange:e=>n({...i,emailFromAddress:e.target.value})})]})]}),e.jsxs(d,{onClick:async()=>{try{const{error:e}=await window.ezsite.apis.sendEmail({from:`${i.emailFromName} <${i.emailFromAddress}>`,to:[i.emailFromAddress],subject:"DFS Manager - Email Configuration Test",html:`\n          <h2>Email Configuration Test</h2>\n          <p>This is a test email to verify your email configuration is working correctly.</p>\n          <p><strong>Site:</strong> ${i.siteName}</p>\n          <p><strong>Time:</strong> ${(new Date).toLocaleString()}</p>\n          <hr>\n          <p>If you received this email, your configuration is working properly.</p>\n        `});if(e)throw e;le({title:"Test Email Sent",description:"Check your inbox for the test email"})}catch(e){console.error("Error sending test email:",e),le({title:"Error",description:"Failed to send test email",variant:"destructive"})}},variant:"outline",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Send Test Email"]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{children:"Security Settings"})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sessionTimeout",children:"Session Timeout (minutes)"}),e.jsx(c,{id:"sessionTimeout",type:"number",value:i.sessionTimeout,onChange:e=>n({...i,sessionTimeout:parseInt(e.target.value)||30})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"passwordMinLength",children:"Password Min Length"}),e.jsx(c,{id:"passwordMinLength",type:"number",value:i.passwordMinLength,onChange:e=>n({...i,passwordMinLength:parseInt(e.target.value)||8})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"logRetentionDays",children:"Log Retention (days)"}),e.jsx(c,{id:"logRetentionDays",type:"number",value:i.logRetentionDays,onChange:e=>n({...i,logRetentionDays:parseInt(e.target.value)||30})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Password Complexity"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Require complex passwords"})]}),e.jsx(p,{checked:i.requirePasswordComplexity,onCheckedChange:e=>n({...i,requirePasswordComplexity:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable 2FA for all users"})]}),e.jsx(p,{checked:i.enableTwoFactor,onCheckedChange:e=>n({...i,enableTwoFactor:e})})]})]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"File Upload Settings"})]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"maxFileSize",children:"Max File Size (MB)"}),e.jsx(c,{id:"maxFileSize",type:"number",value:i.maxFileSize,onChange:e=>n({...i,maxFileSize:parseInt(e.target.value)||10})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"allowedFileTypes",children:"Allowed File Types"}),e.jsx(c,{id:"allowedFileTypes",value:i.allowedFileTypes,onChange:e=>n({...i,allowedFileTypes:e.target.value}),placeholder:"jpg,png,pdf,doc"})]})]})})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:"Current Configuration"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Registration"}),e.jsx(j,{className:me(i.enableRegistration),children:i.enableRegistration?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Notifications"}),e.jsx(j,{className:me(i.enableNotifications),children:i.enableNotifications?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Maintenance"}),e.jsx(j,{className:me(i.enableMaintenance),children:i.enableMaintenance?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Two-Factor"}),e.jsx(j,{className:me(i.enableTwoFactor),children:i.enableTwoFactor?"Required":"Optional"})]})]})})]}),e.jsx(Q,{open:D,onOpenChange:k,station:F,onSave:handleStationSaved,mode:Z}),e.jsx(Q,{open:D,onOpenChange:k,mode:Z,station:F,onSuccess:e=>{k(!1),M(null)}}),e.jsx(f,{isOpen:X,onClose:()=>Y(!1),onSave:async()=>{ae(!0);try{const e=ce.getSelectedData(r,e=>e.id);for(const s of e){const e={...s,...de.status&&{status:de.status},...de.manager_name&&{manager_name:de.manager_name},...de.operating_hours&&{operating_hours:de.operating_hours}},a=await C(e);if(!a.success)throw new Error(a.error||`Failed to update ${s.station_name}`)}le({title:"Success",description:`Updated ${e.length} stations successfully`}),Y(!1),ce.clearSelection()}catch(e){console.error("Error in batch edit:",e),le({title:"Error",description:e.message||"Failed to update stations",variant:"destructive"})}finally{ae(!1)}},selectedCount:ce.selectedCount,isLoading:se,itemName:"stations",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"batch_status",children:"Status"}),e.jsxs("select",{id:"batch_status",title:"Station Status",value:de.status,onChange:e=>oe({...de,status:e.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Keep existing status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"batch_manager",children:"Manager Name"}),e.jsx(c,{id:"batch_manager",value:de.manager_name,onChange:e=>oe({...de,manager_name:e.target.value}),placeholder:"Leave empty to keep existing managers"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"batch_hours",children:"Operating Hours"}),e.jsx(c,{id:"batch_hours",value:de.operating_hours,onChange:e=>oe({...de,operating_hours:e.target.value}),placeholder:"Leave empty to keep existing hours"})]})]})}),e.jsx(w,{isOpen:J,onClose:()=>ee(!1),onConfirm:async()=>{ae(!0);try{const e=ce.getSelectedData(r,e=>e.id);for(const s of e){const e=await _(s.id);if(!e.success)throw new Error(e.error||`Failed to delete ${s.station_name}`)}le({title:"Success",description:`Deleted ${e.length} stations successfully`}),ee(!1),ce.clearSelection()}catch(e){console.error("Error in batch delete:",e),le({title:"Error",description:e.message||"Failed to delete stations",variant:"destructive"})}finally{ae(!1)}},selectedCount:ce.selectedCount,isLoading:se,itemName:"stations",selectedItems:ce.getSelectedData(r,e=>e.id).map(e=>({id:e.id,name:e.station_name}))})]}):e.jsx(K,{feature:"Site Management",requiredRole:"Administrator"})};export{Z as default};
