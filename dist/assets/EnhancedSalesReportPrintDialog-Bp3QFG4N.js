import{j as n}from"./radix-ui-woSLwCdF.js";import{D as e,a,b as s,c as t,C as i,f as l,g as d,B as r,h as c,S as o,o as m,e as p}from"./index-MtEqlP9w.js";import{al as x,D as v,ad as h,p as g,s as u,X as b,a9 as f}from"./utilities-BBdJI3Xi.js";const j=({open:j,onOpenChange:y,report:N})=>{if(!N)return null;const _=n=>n?new Date(n).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A",w=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n||0),$=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});let C=[],S=0,k=0,D=0,O=0;if(N.expenses_data)try{const n=JSON.parse(N.expenses_data);void 0!==n.total_expenses?(S=n.total_expenses||0,k=n.cash_expenses||0,D=S-k,C=n.expenses||[]):Array.isArray(n)&&(C=n,S=C.reduce((n,e)=>n+e.amount,0),k=C.filter(n=>"Cash"===n.paymentType).reduce((n,e)=>n+e.amount,0),D=C.filter(n=>"Credit Card"===n.paymentType).reduce((n,e)=>n+e.amount,0),O=C.filter(n=>"Cheque"===n.paymentType).reduce((n,e)=>n+e.amount,0))}catch(B){console.error("Error parsing expenses data:",B)}const z=N.credit_card_amount+N.debit_card_amount+N.mobile_amount+N.cash_amount;N.regular_gallons,N.super_gallons,N.diesel_gallons;const E=Math.abs(z+N.grocery_sales-N.total_sales)<=.01,M=Math.abs(N.total_short_over)<=1;return n.jsx(e,{open:j,onOpenChange:y,children:n.jsxs(a,{className:"max-w-7xl max-h-[95vh] overflow-y-auto",children:[n.jsx(s,{children:n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs(t,{className:"flex items-center gap-2",children:[n.jsx(x,{className:"h-5 w-5 text-blue-600"}),"Enhanced Sales Report - ",N.station]})})}),n.jsxs("div",{className:"space-y-6",children:[n.jsx(i,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:n.jsx(l,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(d,{className:"text-blue-800",children:_(N.report_date)}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx(r,{className:(n=>{switch(n.toUpperCase()){case"MOBIL":return"bg-red-500 text-white";case"AMOCO ROSEDALE":return"bg-blue-500 text-white";case"AMOCO BROOKLYN":return"bg-green-500 text-white";default:return"bg-gray-500 text-white"}})(N.station),children:N.station}),n.jsxs("span",{className:"text-sm text-gray-600",children:["Employee: ",N.employee_name]}),N.shift&&n.jsx(r,{variant:"outline",children:N.shift})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-800",children:w(N.total_sales)}),n.jsx("div",{className:"text-sm text-gray-600",children:"Total Sales"})]})]})})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(i,{children:n.jsxs(c,{className:"p-4 text-center",children:[n.jsx(v,{className:"h-8 w-8 mx-auto text-green-600 mb-2"}),n.jsx("div",{className:"text-2xl font-bold text-green-600",children:w(N.total_sales)}),n.jsx("div",{className:"text-sm text-gray-600",children:"Total Sales"})]})}),n.jsx(i,{children:n.jsxs(c,{className:"p-4 text-center",children:[n.jsx(h,{className:"h-8 w-8 mx-auto text-blue-600 mb-2"}),n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:$(N.total_gallons)}),n.jsx("div",{className:"text-sm text-gray-600",children:"Total Gallons"})]})}),n.jsx(i,{children:n.jsxs(c,{className:"p-4 text-center",children:[n.jsx(g,{className:"h-8 w-8 mx-auto text-purple-600 mb-2"}),n.jsx("div",{className:"text-2xl font-bold text-purple-600",children:w(N.lottery_total_cash)}),n.jsx("div",{className:"text-sm text-gray-600",children:"Lottery Sales"})]})})]}),n.jsxs(i,{className:"border-2 "+(E&&M?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[n.jsx(l,{children:n.jsx(d,{className:"flex items-center gap-2",children:E&&M?n.jsx("div",{className:"text-green-600",children:"‚úì Report Verified"}):n.jsxs("div",{className:"text-red-600 flex items-center gap-2",children:[n.jsx(u,{className:"h-5 w-5"}),"Discrepancies Found"]})})}),n.jsx(c,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Payment Balance:"}),n.jsx("span",{className:E?"text-green-600 font-medium":"text-red-600 font-medium",children:E?"‚úì Balanced":`‚ö†Ô∏è ${w(Math.abs(z+N.grocery_sales-N.total_sales))} difference`})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Cash Balance:"}),n.jsx("span",{className:M?"text-green-600 font-medium":"text-red-600 font-medium",children:M?"‚úì Within tolerance":`‚ö†Ô∏è ${w(Math.abs(N.total_short_over))}`})]})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs(i,{children:[n.jsx(l,{children:n.jsx(d,{className:"text-sm",children:"Payment Methods"})}),n.jsxs(c,{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Credit Card:"}),n.jsx("span",{className:"font-medium",children:w(N.credit_card_amount)})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Debit Card:"}),n.jsx("span",{className:"font-medium",children:w(N.debit_card_amount)})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Mobile:"}),n.jsx("span",{className:"font-medium",children:w(N.mobile_amount)})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Cash:"}),n.jsx("span",{className:"font-medium",children:w(N.cash_amount)})]})]})]}),n.jsxs(i,{children:[n.jsx(l,{children:n.jsx(d,{className:"text-sm",children:"Fuel Sales"})}),n.jsxs(c,{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Regular:"}),n.jsxs("span",{className:"font-medium",children:[$(N.regular_gallons)," gal"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Super:"}),n.jsxs("span",{className:"font-medium",children:[$(N.super_gallons)," gal"]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Diesel:"}),n.jsxs("span",{className:"font-medium",children:[$(N.diesel_gallons)," gal"]})]}),n.jsx(o,{}),n.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[n.jsx("span",{children:"Total:"}),n.jsxs("span",{children:[$(N.total_gallons)," gal"]})]})]})]})]}),S>0&&n.jsxs(i,{children:[n.jsx(l,{children:n.jsxs(d,{className:"text-sm",children:["Expenses Summary - Total: ",w(S)]})}),n.jsx(c,{children:n.jsxs("div",{className:"text-sm text-gray-600",children:["Cash: ",w(k)," | Card: ",w(D)," | Cheque: ",w(O)]})})]}),N.notes&&n.jsxs(i,{children:[n.jsx(l,{children:n.jsx(d,{className:"text-sm",children:"Notes"})}),n.jsx(c,{children:n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:N.notes})})]})]}),n.jsxs(m,{className:"flex justify-end space-x-2",children:[n.jsxs(p,{variant:"outline",onClick:()=>y(!1),children:[n.jsx(b,{className:"w-4 h-4 mr-2"}),"Close"]}),n.jsxs(p,{onClick:()=>{const n=`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Enhanced Sales Report - ${N.station} - ${_(N.report_date)}</title>\n          <style>\n            @page {\n              size: letter;\n              margin: 0.4in 0.5in;\n            }\n            body {\n              font-family: 'Arial', sans-serif;\n              margin: 0;\n              padding: 0;\n              color: #333;\n              line-height: 1.2;\n              font-size: 11px;\n            }\n            .header {\n              text-align: center;\n              margin-bottom: 12px;\n              border-bottom: 2px solid #2563eb;\n              padding-bottom: 8px;\n            }\n            .company-logo {\n              font-size: 18px;\n              font-weight: bold;\n              color: #1e40af;\n              margin-bottom: 2px;\n            }\n            .report-title {\n              font-size: 14px;\n              color: #374151;\n              margin-bottom: 4px;\n            }\n            .report-meta {\n              display: grid;\n              grid-template-columns: repeat(3, 1fr);\n              gap: 8px;\n              background: #f8fafc;\n              padding: 6px;\n              border-radius: 4px;\n              margin-bottom: 12px;\n            }\n            .meta-item {\n              text-align: center;\n            }\n            .meta-label {\n              font-size: 9px;\n              color: #6b7280;\n              text-transform: uppercase;\n              font-weight: 600;\n            }\n            .meta-value {\n              font-size: 11px;\n              font-weight: bold;\n              margin-top: 2px;\n            }\n            .station-badge {\n              display: inline-block;\n              padding: 2px 8px;\n              border-radius: 12px;\n              color: white;\n              font-size: 9px;\n              font-weight: 600;\n            }\n            .section {\n              margin-bottom: 12px;\n              break-inside: avoid;\n            }\n            .section-header {\n              display: flex;\n              align-items: center;\n              margin-bottom: 6px;\n              padding-bottom: 4px;\n              border-bottom: 1px solid #e5e7eb;\n            }\n            .section-icon {\n              margin-right: 4px;\n              color: #2563eb;\n              font-size: 12px;\n            }\n            .section-title {\n              font-size: 12px;\n              font-weight: bold;\n              color: #1f2937;\n            }\n            .data-grid {\n              display: grid;\n              grid-template-columns: repeat(4, 1fr);\n              gap: 8px;\n            }\n            .data-card {\n              border: 1px solid #e5e7eb;\n              border-radius: 4px;\n              padding: 6px;\n              background: #ffffff;\n            }\n            .data-label {\n              font-size: 8px;\n              color: #6b7280;\n              text-transform: uppercase;\n              font-weight: 600;\n              margin-bottom: 2px;\n            }\n            .data-value {\n              font-size: 11px;\n              font-weight: bold;\n              color: #1f2937;\n            }\n            .currency {\n              color: #059669;\n            }\n            .gallons {\n              color: #2563eb;\n            }\n            .summary-card {\n              background: linear-gradient(135deg, #3b82f6, #1d4ed8);\n              color: white;\n              padding: 8px;\n              border-radius: 6px;\n              margin: 8px 0;\n            }\n            .summary-grid {\n              display: grid;\n              grid-template-columns: repeat(3, 1fr);\n              gap: 8px;\n              text-align: center;\n            }\n            .summary-amount {\n              font-size: 14px;\n              font-weight: bold;\n              margin-bottom: 2px;\n            }\n            .summary-label {\n              font-size: 9px;\n              opacity: 0.9;\n            }\n            .expenses-table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-top: 4px;\n            }\n            .expenses-table th,\n            .expenses-table td {\n              padding: 4px;\n              text-align: left;\n              border-bottom: 1px solid #e5e7eb;\n              font-size: 9px;\n            }\n            .expenses-table th {\n              background: #f3f4f6;\n              font-weight: 600;\n              text-transform: uppercase;\n            }\n            .verification-section {\n              background: #f0fdf4;\n              border: 1px solid #10b981;\n              border-radius: 4px;\n              padding: 8px;\n              margin: 8px 0;\n            }\n            .verification-failed {\n              background: #fef2f2;\n              border-color: #ef4444;\n            }\n            .verification-item {\n              display: flex;\n              justify-content: space-between;\n              align-items: center;\n              margin-bottom: 4px;\n              font-size: 9px;\n            }\n            .check-passed {\n              color: #059669;\n              font-weight: bold;\n            }\n            .check-failed {\n              color: #dc2626;\n              font-weight: bold;\n            }\n            .footer {\n              margin-top: 12px;\n              text-align: center;\n              font-size: 8px;\n              color: #6b7280;\n              border-top: 1px solid #e5e7eb;\n              padding-top: 8px;\n            }\n            .notes-section {\n              background: #fffbeb;\n              border-left: 2px solid #f59e0b;\n              padding: 8px;\n              margin: 8px 0;\n            }\n            .two-column {\n              display: grid;\n              grid-template-columns: 1fr 1fr;\n              gap: 12px;\n            }\n            .compact-grid {\n              display: grid;\n              grid-template-columns: repeat(6, 1fr);\n              gap: 4px;\n            }\n            @media print {\n              body { \n                font-size: 10px !important;\n                line-height: 1.1 !important;\n              }\n              .section { \n                page-break-inside: avoid;\n                margin-bottom: 8px !important;\n              }\n              .header {\n                margin-bottom: 8px !important;\n              }\n              .summary-card {\n                margin: 6px 0 !important;\n                padding: 6px !important;\n              }\n              .data-card {\n                padding: 4px !important;\n              }\n              .verification-section {\n                margin: 6px 0 !important;\n                padding: 6px !important;\n              }\n              .notes-section {\n                margin: 6px 0 !important;\n                padding: 6px !important;\n              }\n              .footer {\n                margin-top: 8px !important;\n                padding-top: 6px !important;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <div class="company-logo">DFS Manager Portal</div>\n            <div class="report-title">Daily Sales Report - Enhanced</div>\n          </div>\n\n          <div class="report-meta">\n            <div class="meta-item">\n              <div class="meta-label">Report Date</div>\n              <div class="meta-value">${_(N.report_date)}</div>\n            </div>\n            <div class="meta-item">\n              <div class="meta-label">Station</div>\n              <div class="meta-value">\n                <span class="station-badge" style="background: ${"MOBIL"===N.station?"#ef4444":"AMOCO ROSEDALE"===N.station?"#3b82f6":"#10b981"}">${N.station}</span>\n              </div>\n            </div>\n            <div class="meta-item">\n              <div class="meta-label">Employee</div>\n              <div class="meta-value">${N.employee_name}</div>\n            </div>\n          </div>\n\n          <div class="summary-card">\n            <div class="summary-grid">\n              <div>\n                <div class="summary-amount">${w(N.total_sales)}</div>\n                <div class="summary-label">Total Sales</div>\n              </div>\n              <div>\n                <div class="summary-amount">${$(N.total_gallons)} gal</div>\n                <div class="summary-label">Total Gallons</div>\n              </div>\n              <div>\n                <div class="summary-amount">${w(N.lottery_total_cash)}</div>\n                <div class="summary-label">Lottery Sales</div>\n              </div>\n            </div>\n          </div>\n\n          <div class="two-column">\n            <div class="section">\n              <div class="section-header">\n                <span class="section-icon">üí∞</span>\n                <span class="section-title">Cash Collection & Balance</span>\n              </div>\n              <div class="compact-grid">\n                <div class="data-card">\n                  <div class="data-label">Cash on Hand</div>\n                  <div class="data-value currency">${w(N.cash_collection_on_hand)}</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Short/Over</div>\n                  <div class="data-value ${N.total_short_over>=0?"check-passed":"check-failed"}">${w(N.total_short_over)}</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Cash Sales</div>\n                  <div class="data-value currency">${w(N.cash_amount)}</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Cash Expenses</div>\n                  <div class="data-value currency">${w(k)}</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Credit Card</div>\n                  <div class="data-value currency">${w(N.credit_card_amount)}</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Debit Card</div>\n                  <div class="data-value currency">${w(N.debit_card_amount)}</div>\n                </div>\n              </div>\n            </div>\n\n            <div class="section">\n              <div class="section-header">\n                <span class="section-icon">‚õΩ</span>\n                <span class="section-title">Fuel & Store Sales</span>\n              </div>\n              <div class="compact-grid">\n                <div class="data-card">\n                  <div class="data-label">Regular Gallons</div>\n                  <div class="data-value gallons">${$(N.regular_gallons)} gal</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Super Gallons</div>\n                  <div class="data-value gallons">${$(N.super_gallons)} gal</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Diesel Gallons</div>\n                  <div class="data-value gallons">${$(N.diesel_gallons)} gal</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Grocery Sales</div>\n                  <div class="data-value currency">${w(N.grocery_sales)}</div>\n                </div>\n                ${"MOBIL"===N.station?`\n                <div class="data-card">\n                  <div class="data-label">EBT Sales</div>\n                  <div class="data-value currency">${w(N.ebt_sales)}</div>\n                </div>\n                `:""}\n                <div class="data-card">\n                  <div class="data-label">Lottery Net</div>\n                  <div class="data-value currency">${w(N.lottery_net_sales)}</div>\n                </div>\n                <div class="data-card">\n                  <div class="data-label">Scratch-off</div>\n                  <div class="data-value currency">${w(N.scratch_off_sales)}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          ${S>0?`\n          <div class="section">\n            <div class="section-header">\n              <span class="section-icon">üìã</span>\n              <span class="section-title">Expenses: ${w(S)}</span>\n            </div>\n            <div class="data-grid">\n              <div class="data-card">\n                <div class="data-label">Cash</div>\n                <div class="data-value currency">${w(k)}</div>\n              </div>\n              <div class="data-card">\n                <div class="data-label">Card</div>\n                <div class="data-value currency">${w(D)}</div>\n              </div>\n              <div class="data-card">\n                <div class="data-label">Cheque</div>\n                <div class="data-value currency">${w(O)}</div>\n              </div>\n              <div class="data-card">\n                <div class="data-label">Mobile Pay</div>\n                <div class="data-value currency">${w(N.mobile_amount)}</div>\n              </div>\n            </div>\n          </div>\n          `:""}\n\n          <div class="verification-section ${E&&M?"":"verification-failed"}">\n            <div class="section-header">\n              <span class="section-icon">‚úì</span>\n              <span class="section-title">Verification: ${E&&M?"Passed":"Failed"}</span>\n            </div>\n            <div class="verification-item">\n              <span>Payment Balance:</span>\n              <span class="${E?"check-passed":"check-failed"}">\n                ${E?"‚úì":"‚ö†Ô∏è "+w(Math.abs(z+N.grocery_sales-N.total_sales))}\n              </span>\n            </div>\n            <div class="verification-item">\n              <span>Cash Balance:</span>\n              <span class="${M?"check-passed":"check-failed"}">\n                ${M?"‚úì":"‚ö†Ô∏è"}\n              </span>\n            </div>\n            <div class="verification-item">\n              <span>Documents:</span>\n              <span class="check-passed">‚úì</span>\n            </div>\n          </div>\n\n          ${N.notes?`\n          <div class="notes-section">\n            <div class="section-header">\n              <span class="section-icon">üìù</span>\n              <span class="section-title">Notes</span>\n            </div>\n            <p style="margin: 0; white-space: pre-wrap; font-size: 9px; line-height: 1.2;">${N.notes}</p>\n          </div>\n          `:""}\n\n          <div class="footer">\n            <div>Report ID: #${N.ID} | Generated: ${(new Date).toLocaleString()} | User: #${N.created_by}</div>\n            <div style="font-style: italic;">DFS Manager Portal v2.0 - Official Business Document</div>\n          </div>\n        </body>\n      </html>\n    `,e=window.open("","_blank");e&&(e.document.write(n),e.document.close(),e.focus(),setTimeout(()=>{e.print(),e.close()},500))},className:"bg-blue-600 hover:bg-blue-700",children:[n.jsx(f,{className:"w-4 h-4 mr-2"}),"Print Full Report"]})]})]})})};export{j as E};
