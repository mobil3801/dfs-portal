import{j as e}from"./radix-ui-woSLwCdF.js";import{j as s,e as a,A as l,n as t,C as i,h as d,f as c,g as n,B as r,k as m,L as x,S as o,M as h}from"./index-CIZJQuMw.js";import{r as j}from"./react-core-CKNU0hQt.js";import{S as u}from"./switch-C1qVBy4u.js";import{z as p,g as N,R as b,aw as f,s as g,W as v,Z as w,V as y}from"./utilities-DMEd7dY0.js";import"./routing-DcURAnU1.js";import"./data-management-r38r-ocq.js";import"./animations-CdlE0-Ca.js";const _=()=>{const{moduleAccess:h,loading:_,error:C,updateModuleAccess:A,createDefaultModules:F,fetchModuleAccess:k,isModuleAccessEnabled:M}=s(),[D,E]=j.useState(new Set),S=async(e,s,a)=>{E(s=>new Set(s).add(e));try{await A(e,{[s]:a})}catch(l){console.error("Failed to update module access:",l)}finally{E(s=>{const a=new Set(s);return a.delete(e),a})}},z=async()=>{await F()};return _&&0===h.length?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(p,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading module access settings..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Real-Time Module Access Control"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(a,{variant:"outline",size:"sm",onClick:async()=>{await k()},disabled:_,children:[e.jsx(b,{className:"h-4 w-4 mr-2 "+(_?"animate-spin":"")}),"Refresh"]}),0===h.length&&e.jsxs(a,{onClick:z,disabled:_,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Initialize Modules"]})]})]}),e.jsx("p",{className:"text-gray-600",children:"Control which CRUD operations are available for each module in real-time. When disabled, users won't see the corresponding action buttons."}),!M&&e.jsxs(l,{children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(t,{children:"Module access system is currently disabled. All permissions are set to allow by default."})]}),C&&e.jsxs(l,{variant:"destructive",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsxs(t,{children:["Error: ",C]})]}),0===h.length?e.jsx(i,{className:"border-dashed border-2",children:e.jsx(d,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Module Access Configuration Found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Initialize the module access system to start controlling permissions."}),e.jsxs(a,{onClick:z,disabled:_,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Initialize Default Modules"]})]})})}):e.jsx("div",{className:"grid gap-4",children:h.map(s=>{const a=D.has(s.id);return e.jsxs(i,{className:"border-l-4 border-l-blue-500 relative",children:[a&&e.jsx("div",{className:"absolute inset-0 bg-white/50 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-white px-3 py-2 rounded-lg shadow-lg",children:[e.jsx(p,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Updating..."})]})}),e.jsxs(c,{children:[e.jsxs(n,{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.display_name}),e.jsx(r,{variant:"outline",children:s.module_name})]}),e.jsxs(m,{children:["Control access to ",s.display_name," module operations"]})]}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-4 w-4 text-green-600"}),e.jsx(x,{htmlFor:`create-${s.id}`,className:"text-sm font-medium",children:"Create Access"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{id:`create-${s.id}`,checked:s.create_enabled,onCheckedChange:e=>S(s.id,"create_enabled",e),disabled:a}),e.jsx("span",{className:"text-sm text-gray-600",children:s.create_enabled?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-4 w-4 text-blue-600"}),e.jsx(x,{htmlFor:`edit-${s.id}`,className:"text-sm font-medium",children:"Edit Access"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{id:`edit-${s.id}`,checked:s.edit_enabled,onCheckedChange:e=>S(s.id,"edit_enabled",e),disabled:a}),e.jsx("span",{className:"text-sm text-gray-600",children:s.edit_enabled?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-red-600"}),e.jsx(x,{htmlFor:`delete-${s.id}`,className:"text-sm font-medium",children:"Delete Access"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{id:`delete-${s.id}`,checked:s.delete_enabled,onCheckedChange:e=>S(s.id,"delete_enabled",e),disabled:a}),e.jsx("span",{className:"text-sm text-gray-600",children:s.delete_enabled?"Enabled":"Disabled"})]})]})]}),e.jsx(o,{className:"my-4"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{variant:s.create_enabled?"default":"secondary",children:["Create: ",s.create_enabled?"ON":"OFF"]}),e.jsxs(r,{variant:s.edit_enabled?"default":"secondary",children:["Edit: ",s.edit_enabled?"ON":"OFF"]}),e.jsxs(r,{variant:s.delete_enabled?"default":"secondary",children:["Delete: ",s.delete_enabled?"ON":"OFF"]}),e.jsxs(r,{variant:"outline",className:"text-xs",children:["Updated: ",new Date(s.updated_at).toLocaleString()]})]})]})]},s.id)})}),_&&h.length>0&&e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx(p,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("span",{children:"Updating module access..."})]})]})},C=()=>e.jsx(h,{children:e.jsx("div",{className:"container mx-auto p-6",children:e.jsx(_,{})})});export{C as default};
