import{j as e}from"./radix-ui-woSLwCdF.js";import{r as s}from"./react-core-CKNU0hQt.js";import{u as a,l as t,C as i,T as n,q as r,r as l,s as o,B as c,e as d}from"./index-MtEqlP9w.js";import{A as m}from"./AccessDenied-ClLBz1Lo.js";import{R as g}from"./RealTimeAdminDashboard-BMIiC_nG.js";import{u as x}from"./routing-DcURAnU1.js";import{A as h,l as u,g as j,ax as p,S as v,aH as y,ap as f,T as N,C as w,f as b}from"./utilities-BBdJI3Xi.js";import"./data-management-r38r-ocq.js";import"./animations-CdlE0-Ca.js";import"./progress-BWE2IKwJ.js";import"./table-DnenzOH_.js";import"./select-D0O4Kb7R.js";import"./CreateUserDialog-BPF1loCs.js";const C=({title:s,value:a,icon:t,color:n,onClick:r,loading:l,systemHealth:o})=>{let c;return c=l?"...":"error"===o?"Error":a,e.jsx(i,{className:"p-6 cursor-pointer hover:shadow-lg transition-shadow "+(r?"hover:bg-gray-50":""),onClick:r,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-bold",children:c})]}),e.jsx(t,{className:`h-8 w-8 ${n}`})]})})},S=({title:s,description:a,icon:t,onClick:n,variant:r="default"})=>e.jsxs(i,{className:"p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[e.jsx(t,{className:"h-6 w-6 text-blue-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:a})]})]}),e.jsxs(d,{onClick:n,variant:r,size:"sm",className:"w-full",children:["Access ",s]})]}),A=()=>{const{isAdmin:d,user:A}=a(),k=x(),{toast:P}=t(),[H,M]=s.useState({totalUsers:0,activeUsers:0,totalAuditLogs:0,todaysActivity:0,systemHealth:"healthy"}),[D,T]=s.useState(!0);if(s.useEffect(()=>{const e=async()=>{try{T(!0);const e=await window.ezsite.apis.tablePage(11725,{PageNo:1,PageSize:1}),s=await window.ezsite.apis.tablePage(11725,{PageNo:1,PageSize:1,Filters:[{name:"is_active",op:"Equal",value:!0}]}),a=new Date;a.setHours(0,0,0,0);const t=new Date(a);t.setDate(t.getDate()+1);const i=await window.ezsite.apis.tablePage(12706,{PageNo:1,PageSize:1,Filters:[{name:"event_timestamp",op:"GreaterThanOrEqual",value:a.toISOString()},{name:"event_timestamp",op:"LessThan",value:t.toISOString()}]}),n=await window.ezsite.apis.tablePage(12706,{PageNo:1,PageSize:1});M({totalUsers:e.data?.VirtualCount||0,activeUsers:s.data?.VirtualCount||0,totalAuditLogs:n.data?.VirtualCount||0,todaysActivity:i.data?.VirtualCount||0,systemHealth:"healthy"})}catch(e){console.error("Error fetching admin stats:",e),M(e=>({...e,systemHealth:"error"})),P({title:"Error",description:"Failed to load admin dashboard data",variant:"destructive"})}finally{T(!1)}};if(d()){e();const s=setInterval(e,12e4);return()=>clearInterval(s)}},[d,P]),!d())return e.jsx(m,{feature:"Admin Panel",requiredRole:"Administrator"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-purple-600 rounded-lg p-6 text-white",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Real-Time Admin Panel"}),e.jsxs("p",{className:"opacity-90",children:["Administrator: ",A?.Name||"Loading..."," • Full System Access • Live Database Integration"]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm",children:"Production Database Connected"})]})]}),e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"System Status"})]}),(()=>{const s=H.systemHealth;return"healthy"===s?e.jsxs(c,{className:"bg-green-100 text-green-800",children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),"Healthy"]}):"warning"===s?e.jsxs(c,{className:"bg-yellow-100 text-yellow-800",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),"Warning"]}):e.jsxs(c,{className:"bg-red-100 text-red-800",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"Error"]})})()]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(C,{title:"Total Users",value:H.totalUsers,icon:u,color:"text-blue-600",onClick:()=>k("/admin/users"),loading:D,systemHealth:H.systemHealth}),e.jsx(C,{title:"Active Users",value:H.activeUsers,icon:j,color:"text-green-600",loading:D,systemHealth:H.systemHealth}),e.jsx(C,{title:"Total Audit Logs",value:H.totalAuditLogs,icon:p,color:"text-purple-600",onClick:()=>k("/admin/audit"),loading:D,systemHealth:H.systemHealth}),e.jsx(C,{title:"Today's Activity",value:H.todaysActivity,icon:h,color:"text-orange-600",loading:D,systemHealth:H.systemHealth})]}),e.jsxs(n,{defaultValue:"management",className:"space-y-4",children:[e.jsxs(r,{className:"grid w-full lg:w-[600px] grid-cols-3",children:[e.jsx(l,{value:"management",children:"User Management"}),e.jsx(l,{value:"system",children:"System"}),e.jsx(l,{value:"monitoring",children:"Monitoring"})]}),e.jsxs(o,{value:"management",className:"space-y-4",children:[e.jsx("div",{className:"mb-6",children:e.jsx(g,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(S,{title:"User Management",description:"Manage user accounts, roles, and permissions",icon:u,onClick:()=>k("/admin/users")}),e.jsx(S,{title:"Site Management",description:"Configure stations and locations",icon:v,onClick:()=>k("/admin/sites")}),e.jsx(S,{title:"Security Settings",description:"Manage security policies and access controls",icon:j,onClick:()=>k("/admin/security")}),e.jsx(S,{title:"User Validation",description:"Role conflict prevention & email uniqueness validation",icon:j,onClick:()=>k("/admin/user-validation")})]})]}),e.jsx(o,{value:"system",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(S,{title:"Database Monitoring",description:"Monitor database performance and connections",icon:p,onClick:()=>k("/admin/database")}),e.jsx(S,{title:"Database Schema Diagnostics",description:"Diagnose PostgreSQL schema issues (42P01, 42703 errors)",icon:y,onClick:()=>k("/admin/database-diagnostics")}),e.jsx(S,{title:"SMS Management",description:"Configure SMS alerts and notifications",icon:f,onClick:()=>k("/admin/sms")}),e.jsx(S,{title:"System Logs",description:"View and manage system logs",icon:h,onClick:()=>k("/admin/logs")})]})}),e.jsx(o,{value:"monitoring",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(S,{title:"Audit Monitoring",description:"Review audit logs and user activity",icon:j,onClick:()=>k("/admin/audit")}),e.jsx(S,{title:"Error Monitoring",description:"Track and resolve system errors",icon:N,onClick:()=>k("/admin/errors"),variant:"secondary"}),e.jsx(S,{title:"Performance Monitor",description:"Monitor system performance metrics",icon:h,onClick:()=>k("/admin/performance")}),e.jsx(S,{title:"Overflow Testing",description:"Test responsive design and navigation overflow behavior",icon:y,onClick:()=>k("/overflow-testing")})]})})]}),e.jsxs(i,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Quick Information"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("p",{children:"• System is operating normally"}),e.jsxs("p",{children:["• Last data refresh: ",(new Date).toLocaleTimeString()]}),e.jsx("p",{children:"• All critical services are running"}),e.jsx("p",{children:"• Database connection is stable"})]})]})]})};export{A as default};
