import{j as e}from"./radix-ui-BhRELLXi.js";import{u as s,f as i,C as a,g as n,h as t,l,i as r,p as c,q as d,r as o,s as m,B as h,A as x,m as j,v as u}from"./index-s81fdLZV.js";import{r as g}from"./react-core-CKNU0hQt.js";import{a as v}from"./routing-DcURAnU1.js";import{H as N,P as f,F as p,i as b,j as y,k as w,m as A,D as S,S as I,d as q,v as R,w as D,R as E,e as C,av as k,q as z,aM as U,aN as M,aO as L}from"./utilities-DVevn_gw.js";import{A as P}from"./AccessDenied-wxYpicIE.js";import"./data-management-CF8GQrOz.js";import"./animations-Cc9qW4PM.js";const F=()=>{const{user:u,userProfile:P,isAuthenticated:F,isLoading:H,isInitialized:V,isAdmin:Y,isManager:O,authError:T,refreshUserData:W}=s(),B=v(),[$,Q]=g.useState(!1),[X,G]=g.useState(!1),[J,K]=g.useState("desktop"),[Z,_]=g.useState(!1),ee=[{name:"Dashboard",href:"/dashboard",icon:N,requiredRole:null},{name:"Products",href:"/products",icon:f,requiredRole:null},{name:"Sales",href:"/sales",icon:p,requiredRole:null},{name:"Delivery",href:"/delivery",icon:b,requiredRole:null},{name:"Employees",href:"/employees",icon:y,requiredRole:"manager"},{name:"Vendors",href:"/vendors",icon:w,requiredRole:"manager"},{name:"Orders",href:"/orders",icon:f,requiredRole:"manager"},{name:"Licenses",href:"/licenses",icon:A,requiredRole:"manager"},{name:"Salary",href:"/salary",icon:S,requiredRole:"manager"},{name:"Settings",href:"/settings",icon:I,requiredRole:null},{name:"Admin",href:"/admin",icon:q,requiredRole:"admin"}];g.useEffect(()=>{const e=()=>{const e=window.innerWidth;K(e<768?"mobile":e<1024?"tablet":"desktop")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),g.useEffect(()=>{const e=()=>{const e=document.querySelector("nav"),s=document.querySelectorAll('[data-testid^="nav-"]');_(null!==e&&s.length>0)};e();const s=setInterval(e,1e3);return()=>clearInterval(s)},[]);const se=e=>!e||!!F&&("admin"===e?Y():"manager"!==e||O()),ie=ee.filter(e=>se(e.requiredRole)),ae=ee.filter(e=>!se(e.requiredRole)),ne=B.pathname;ee.find(e=>ne.startsWith(e.href));const te=V,le=H,re=F,ce=!!u,de=ie.length>0,oe=Z,me=V&&!H&&F&&!!u&&ie.length>0&&Z,he=(()=>{const e=[],s=document.querySelector("nav");e.push({test:"Navigation Container",passed:!!s,message:s?"Navigation container found":"Navigation container not found"});const i=document.querySelectorAll('[data-testid^="nav-"]');e.push({test:"Navigation Items",passed:i.length>0,message:`${i.length} navigation items found`});const a=document.querySelector('[data-testid="user-dropdown"]');e.push({test:"User Dropdown",passed:!!a,message:a?"User dropdown found":"User dropdown not found"});const n=document.querySelector('[data-testid="mobile-menu-button"]');return e.push({test:"Mobile Menu Button",passed:!!n,message:n?"Mobile menu button found":"Mobile menu button not found"}),e})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Enhanced Navigation Debugger"}),e.jsx("p",{className:"text-gray-600",children:"Comprehensive navigation analysis and troubleshooting"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(()=>{switch(J){case"mobile":return e.jsx(L,{className:"h-4 w-4"});case"tablet":return e.jsx(M,{className:"h-4 w-4"});default:return e.jsx(U,{className:"h-4 w-4"})}})(),e.jsx("span",{className:"text-sm font-medium",children:J}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>G(!X),children:[X?e.jsx(R,{className:"h-4 w-4 mr-2"}):e.jsx(D,{className:"h-4 w-4 mr-2"}),X?"Hide":"Show"," Details"]}),e.jsxs(i,{onClick:async()=>{Q(!0);try{await W()}catch(e){console.error("Failed to refresh user data:",e)}finally{Q(!1)}},disabled:$,variant:"outline",size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2 "+($?"animate-spin":"")}),"Refresh Data"]})]})]}),e.jsxs(a,{children:[e.jsxs(n,{children:[e.jsxs(t,{className:"flex items-center gap-2",children:[me?e.jsx(C,{className:"h-5 w-5 text-green-500"}):e.jsx(k,{className:"h-5 w-5 text-red-500"}),"Navigation Health Status"]}),e.jsx(l,{children:"Overall navigation system health and visibility"})]}),e.jsx(r,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+(te?"bg-green-500":"bg-red-500")}),e.jsx("span",{className:"text-sm",children:"Auth Initialized"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+(le?"bg-yellow-500":"bg-green-500")}),e.jsx("span",{className:"text-sm",children:"Not Loading"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+(re?"bg-green-500":"bg-red-500")}),e.jsx("span",{className:"text-sm",children:"Authenticated"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+(oe?"bg-green-500":"bg-red-500")}),e.jsx("span",{className:"text-sm",children:"Navigation Visible"})]})]})})]}),e.jsxs(c,{defaultValue:"diagnostics",className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-5",children:[e.jsx(o,{value:"diagnostics",children:"Diagnostics"}),e.jsx(o,{value:"status",children:"Status"}),e.jsx(o,{value:"access",children:"Access Control"}),e.jsx(o,{value:"items",children:"Menu Items"}),e.jsx(o,{value:"troubleshooting",children:"Troubleshooting"})]}),e.jsx(m,{value:"diagnostics",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(n,{children:[e.jsx(t,{children:"Navigation Diagnostics"}),e.jsx(l,{children:"Automated tests for navigation components"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-3",children:he.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[s.passed?e.jsx(C,{className:"h-5 w-5 text-green-500"}):e.jsx(k,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.test}),e.jsx("div",{className:"text-sm text-gray-600",children:s.message})]})]}),e.jsx(h,{variant:s.passed?"default":"destructive",children:s.passed?"PASS":"FAIL"})]},i))})})]})}),e.jsxs(m,{value:"status",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(a,{children:[e.jsx(n,{children:e.jsxs(t,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"Authentication Status"]})}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Initialized:"}),e.jsx(h,{variant:V?"default":"secondary",children:V?"Yes":"No"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Loading:"}),e.jsx(h,{variant:H?"destructive":"default",children:H?"Yes":"No"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Authenticated:"}),e.jsx(h,{variant:F?"default":"destructive",children:F?"Yes":"No"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Has User:"}),e.jsx(h,{variant:u?"default":"destructive",children:u?"Yes":"No"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Has Profile:"}),e.jsx(h,{variant:P?"default":"destructive",children:P?"Yes":"No"})]})]})]}),e.jsxs(a,{children:[e.jsx(n,{children:e.jsxs(t,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"User Information"]})}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Name:"}),e.jsx("span",{className:"font-medium",children:u?.Name||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Email:"}),e.jsx("span",{className:"font-medium",children:X?u?.Email||"N/A":u?.Email?"***@***.com":"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Role:"}),e.jsx(h,{variant:Y()?"default":O()?"secondary":"outline",children:Y()?"Admin":O()?"Manager":"Employee"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"User ID:"}),e.jsx("span",{className:"font-medium",children:u?.ID||"N/A"})]}),X&&P&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Profile Role:"}),e.jsx("span",{className:"font-medium",children:P.role||"N/A"})]})]})]})]}),T&&e.jsxs(x,{variant:"destructive",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsxs(j,{children:[e.jsx("strong",{children:"Authentication Error:"})," ",T]})]})]}),e.jsx(m,{value:"access",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(a,{children:[e.jsxs(n,{children:[e.jsxs(t,{className:"text-green-600",children:["Accessible Items (",ie.length,")"]}),e.jsx(l,{children:"Navigation items the current user can access"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-2",children:ie.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.icon,{className:"h-4 w-4"}),e.jsx("span",{children:s.name})]}),e.jsx(h,{variant:"outline",className:"text-green-600",children:s.requiredRole||"All"})]},s.href))})})]}),e.jsxs(a,{children:[e.jsxs(n,{children:[e.jsxs(t,{className:"text-red-600",children:["Inaccessible Items (",ae.length,")"]}),e.jsx(l,{children:"Navigation items the current user cannot access"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-2",children:ae.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.icon,{className:"h-4 w-4"}),e.jsx("span",{children:s.name})]}),e.jsx(h,{variant:"outline",className:"text-red-600",children:s.requiredRole||"All"})]},s.href))})})]})]})}),e.jsx(m,{value:"items",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(n,{children:[e.jsx(t,{children:"All Navigation Items"}),e.jsx(l,{children:"Complete list of navigation items and their access requirements"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-2",children:ee.map(s=>{const i=se(s.requiredRole),a=ne.startsWith(s.href);return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded border "+(a?"bg-blue-50 border-blue-200":"bg-white"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.icon,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.href})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",children:s.requiredRole||"All Users"}),i?e.jsx(C,{className:"h-5 w-5 text-green-500"}):e.jsx(k,{className:"h-5 w-5 text-red-500"}),a&&e.jsx(h,{variant:"default",children:"Current"})]})]},s.href)})})})]})}),e.jsxs(m,{value:"troubleshooting",className:"space-y-4",children:[e.jsxs(a,{children:[e.jsx(n,{children:e.jsx(t,{children:"Common Issues & Solutions"})}),e.jsx(r,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"✅ FIXED: Navigation Items Not Showing"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-600",children:[e.jsx("li",{children:"• Simplified navigation rendering logic"}),e.jsx("li",{children:"• Removed complex overflow calculations"}),e.jsx("li",{children:"• Direct item rendering without complex state management"}),e.jsx("li",{children:"• Improved authentication state handling"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Navigation Health Check"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-600",children:[e.jsxs("li",{children:["• Authentication: ",re?"✅ Active":"❌ Failed"]}),e.jsxs("li",{children:["• User Data: ",ce?"✅ Loaded":"❌ Missing"]}),e.jsxs("li",{children:["• Navigation Items: ",de?"✅ Available":"❌ None"]}),e.jsxs("li",{children:["• Visual Elements: ",oe?"✅ Visible":"❌ Hidden"]})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Performance Improvements"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-600",children:[e.jsx("li",{children:"• Removed ResizeObserver complexity"}),e.jsx("li",{children:"• Simplified responsive design"}),e.jsx("li",{children:"• Eliminated overflow calculation loops"}),e.jsx("li",{children:"• Fixed mobile navigation state management"})]})]})]})})]}),e.jsxs(a,{children:[e.jsx(n,{children:e.jsx(t,{children:"Debug Information"})}),e.jsx(r,{children:e.jsxs("div",{className:"text-sm space-y-2 font-mono bg-gray-50 p-3 rounded",children:[e.jsxs("div",{children:["Current Path: ",ne]}),e.jsxs("div",{children:["Screen Size: ",J," (","undefined"!=typeof window?window.innerWidth:"N/A","px)"]}),e.jsxs("div",{children:["Navigation Items: ",ee.length]}),e.jsxs("div",{children:["Accessible Items: ",ie.length]}),e.jsxs("div",{children:["Navigation Visible: ",Z?"Yes":"No"]}),e.jsxs("div",{children:["APIs Available: ","undefined"!=typeof window&&window.ezsite?.apis?"Yes":"No"]}),e.jsxs("div",{children:["User Agent: ","undefined"!=typeof window?window.navigator.userAgent.substring(0,50)+"...":"N/A"]}),e.jsxs("div",{children:["Timestamp: ",(new Date).toISOString()]})]})})]})]})]})]})},H=()=>{const{isAdmin:i}=s(),{hasAdminAccess:l}=u();return l?e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Navigation Debug Center"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Diagnose and troubleshoot navigation menu visibility issues"})]}),e.jsxs(h,{variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Admin Tool"]})]}),e.jsxs(x,{children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx(j,{children:"This tool helps diagnose navigation menu issues. Use the tabs below to analyze authentication status, access control, and menu item visibility. If users report missing navigation items, this tool will help identify the root cause."})]}),e.jsx(F,{}),e.jsxs(a,{children:[e.jsx(n,{children:e.jsx(t,{children:"Quick Fixes"})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Navigation Not Showing"}),e.jsx("p",{className:"text-blue-800",children:"Check if user is authenticated and has proper role assignments. Verify authentication state in the Status tab."})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded",children:[e.jsx("h4",{className:"font-medium text-green-900",children:"Missing Admin Items"}),e.jsx("p",{className:"text-green-800",children:"Ensure user profile has 'Administrator' or 'Admin' role in the database. Check user information in the Status tab."})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 rounded",children:[e.jsx("h4",{className:"font-medium text-yellow-900",children:"Loading Issues"}),e.jsx("p",{className:"text-yellow-800",children:"If navigation is stuck loading, check browser console for errors. Try refreshing user data using the Refresh button."})]})]})})]})]}):e.jsx(P,{})};export{H as default};
