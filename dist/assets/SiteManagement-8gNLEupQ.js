import{j as e}from"./radix-ui-woSLwCdF.js";import{r as s}from"./react-core-CKNU0hQt.js";import{l as a,D as t,a as i,b as n,c as r,L as l,I as c,o as d,e as o,v as m,C as h,h as x,f as g,g as u,B as p}from"./index-mhPlV2HJ.js";import{S as j}from"./switch-COYLXjCY.js";import{T as v}from"./textarea-ZGbPhlNp.js";import{u as N,B as y,C as b,a as w}from"./BatchDeleteDialog-Cbm7tjAf.js";import{B as f}from"./BatchEditDialog-Bb-kOTXO.js";import{S,c as C,d as _,a as F,b as M}from"./select-KM6PLuaC.js";import{z as A,aa as E,X as D,Q as k,S as O,R as T,C as I,ax as q,v as z,g as L,W as R,Z as P,V as B,ac as $,a7 as U,n as G,ab as H,I as V}from"./utilities-BBdJI3Xi.js";import{A as K}from"./AccessDenied-BQueiUVK.js";import{s as Q}from"./stationService-CEciqnCB.js";import"./routing-DcURAnU1.js";import"./data-management-r38r-ocq.js";import"./animations-CdlE0-Ca.js";function W({open:m,onOpenChange:h,station:x,onSave:g}){const{toast:u}=a(),[p,j]=s.useState(!1),[v,N]=s.useState({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"});s.useEffect(()=>{x&&N({station_name:x.station_name,address:x.address,phone:x.phone,operating_hours:x.operating_hours,manager_name:x.manager_name,status:x.status})},[x]);const y=(e,s)=>{N(a=>({...a,[e]:s}))},b=v.station_name&&v.address&&v.phone&&v.operating_hours&&v.manager_name;return e.jsx(t,{open:m,onOpenChange:h,children:e.jsxs(i,{className:"sm:max-w-[500px]",children:[e.jsx(n,{children:e.jsx(r,{children:"Edit Station Information"})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),x){j(!0);try{console.log("Updating station:",x.id,v);const e={id:x.id,...v,last_updated:(new Date).toISOString(),created_by:x.created_by},{error:s}=await window.ezsite.apis.tableUpdate(12599,e);if(s)throw s;u({title:"Success",description:"Station information updated successfully"}),g(),h(!1)}catch(s){console.error("Error updating station:",s),u({title:"Error",description:s?.toString()||"Failed to update station information",variant:"destructive"})}finally{j(!1)}}},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"station_name",children:"Station Name"}),e.jsx(c,{id:"station_name",value:v.station_name,onChange:e=>y("station_name",e.target.value),placeholder:"Enter station name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"address",children:"Address"}),e.jsx(c,{id:"address",value:v.address,onChange:e=>y("address",e.target.value),placeholder:"Enter station address",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone Number"}),e.jsx(c,{id:"phone",value:v.phone,onChange:e=>y("phone",e.target.value),placeholder:"(718) 555-0100",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(S,{value:v.status,onValueChange:e=>y("status",e),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsxs(F,{children:[e.jsx(M,{value:"Active",children:"Active"}),e.jsx(M,{value:"Inactive",children:"Inactive"}),e.jsx(M,{value:"Maintenance",children:"Maintenance"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"operating_hours",children:"Operating Hours"}),e.jsx(c,{id:"operating_hours",value:v.operating_hours,onChange:e=>y("operating_hours",e.target.value),placeholder:"24/7 or 6:00 AM - 12:00 AM",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"manager_name",children:"Manager Name"}),e.jsx(c,{id:"manager_name",value:v.manager_name,onChange:e=>y("manager_name",e.target.value),placeholder:"Enter manager name",required:!0})]})]}),e.jsxs(d,{className:"gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(o,{type:"submit",disabled:p||!b,className:"min-w-[100px]",children:p?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})]})})}const X=({open:d,onOpenChange:m,station:h,onSave:x,mode:g})=>{const{toast:u}=a(),[p,j]=s.useState(!1),[N,y]=s.useState({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"});s.useEffect(()=>{h&&"edit"===g?y({id:h.id,station_name:h.station_name||"",address:h.address||"",phone:h.phone||"",operating_hours:h.operating_hours||"",manager_name:h.manager_name||"",status:h.status||"Active"}):"add"===g&&y({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"})},[h,g,d]);const b=()=>{p||m(!1)};return e.jsx(t,{open:d,onOpenChange:b,children:e.jsxs(i,{className:"sm:max-w-md",children:[e.jsx(n,{children:e.jsxs(r,{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"add"===g?"Add New Station":"Edit Station"})]})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),j(!0);try{if(!N.station_name.trim())throw new Error("Station name is required");if(!N.address.trim())throw new Error("Address is required");if(!N.phone.trim())throw new Error("Phone number is required");if(!N.operating_hours.trim())throw new Error("Operating hours are required");if(!N.manager_name.trim())throw new Error("Manager name is required");const e={...N,last_updated:(new Date).toISOString(),created_by:1};if("add"===g){const{error:s}=await window.ezsite.apis.tableCreate(12599,e);if(s)throw s;u({title:"Success",description:"Station added successfully"})}else{const{error:s}=await window.ezsite.apis.tableUpdate(12599,e);if(s)throw s;u({title:"Success",description:"Station updated successfully"})}x(),m(!1)}catch(s){console.error("Error saving station:",s),u({title:"Error",description:"string"==typeof s?s:"Failed to save station",variant:"destructive"})}finally{j(!1)}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"station_name",children:"Station Name *"}),e.jsx(c,{id:"station_name",value:N.station_name,onChange:e=>y({...N,station_name:e.target.value}),placeholder:"e.g., MOBIL, AMOCO ROSEDALE",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"address",children:"Address *"}),e.jsx(v,{id:"address",value:N.address,onChange:e=>y({...N,address:e.target.value}),placeholder:"Full station address",required:!0,rows:2})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(c,{id:"phone",type:"tel",value:N.phone,onChange:e=>y({...N,phone:e.target.value}),placeholder:"(555) 123-4567",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"operating_hours",children:"Operating Hours *"}),e.jsx(c,{id:"operating_hours",value:N.operating_hours,onChange:e=>y({...N,operating_hours:e.target.value}),placeholder:"e.g., 24/7 or 6:00 AM - 12:00 AM",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"manager_name",children:"Manager Name *"}),e.jsx(c,{id:"manager_name",value:N.manager_name,onChange:e=>y({...N,manager_name:e.target.value}),placeholder:"Station manager name",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(S,{value:N.status,onValueChange:e=>y({...N,status:e}),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsxs(F,{children:[e.jsx(M,{value:"Active",children:"Active"}),e.jsx(M,{value:"Inactive",children:"Inactive"}),e.jsx(M,{value:"Maintenance",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsxs(o,{type:"button",variant:"outline",onClick:b,disabled:p,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(o,{type:"submit",disabled:p,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),p?"Saving...":"add"===g?"Add Station":"Update Station"]})]})]})]})})},Y=()=>{const{isAdmin:t}=m(),[i,n]=s.useState({siteName:"DFS Manager Portal",siteDescription:"Comprehensive gas station management system",enableRegistration:!1,enableNotifications:!0,enableMaintenance:!1,maintenanceMessage:"System is under maintenance. Please check back later.",emailFromAddress:"support@ezsite.ai",emailFromName:"DFS Manager Support",maxFileSize:10,allowedFileTypes:"jpg,jpeg,png,pdf,doc,docx,xls,xlsx",sessionTimeout:30,passwordMinLength:8,requirePasswordComplexity:!0,enableTwoFactor:!1,backupFrequency:"daily",logRetentionDays:30}),[r,d]=s.useState([]),[S,C]=s.useState(!0),[_,F]=s.useState(null),[M,A]=s.useState(!1),[D,Y]=s.useState(!1),[Z,J]=s.useState("add"),[ee,se]=s.useState(!1),[ae,te]=s.useState(!1),[ie,ne]=s.useState(!1),[re,le]=s.useState(!1),[ce,de]=s.useState(!1),{toast:oe}=a(),me=N(),[he,xe]=s.useState({status:"",manager_name:"",operating_hours:""}),ge=async()=>{try{const{data:e,error:s}=await window.ezsite.apis.tablePage(12599,{PageNo:1,PageSize:100,OrderByField:"station_name",IsAsc:!0,Filters:[]});if(s)throw s;d(e?.List||[])}catch(e){console.error("Error loading stations:",e),oe({title:"Error",description:"Failed to load station information",variant:"destructive"})}finally{C(!1)}};s.useEffect(()=>{ge()},[]);const ue=()=>{Q.clearCache(),ge()},pe=e=>e?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(O,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Site Management"})]}),e.jsx(o,{onClick:async()=>{de(!0);try{await new Promise(e=>setTimeout(e,1e3)),oe({title:"Success",description:"Site settings saved successfully"})}catch(e){console.error("Error saving settings:",e),oe({title:"Error",description:"Failed to save settings",variant:"destructive"})}finally{de(!1)}},disabled:ce,className:"bg-blue-600 hover:bg-blue-700",children:ce?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(h,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"System Status"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:"Online"})]})]})})}),e.jsx(h,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Database"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:"Connected"})]})]})})}),e.jsx(h,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email Service"}),e.jsx("p",{className:"text-lg font-semibold text-purple-600",children:"Active"})]})]})})}),e.jsx(h,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Security"}),e.jsx("p",{className:"text-lg font-semibold text-orange-600",children:"Protected"})]})]})})})]}),e.jsx(y,{selectedCount:me.selectedCount,onBatchEdit:()=>{0!==me.getSelectedData(r,e=>e.id).length?se(!0):oe({title:"No Selection",description:"Please select stations to edit",variant:"destructive"})},onBatchDelete:()=>{0!==me.getSelectedData(r,e=>e.id).length?te(!0):oe({title:"No Selection",description:"Please select stations to delete",variant:"destructive"})},onClearSelection:me.clearSelection,isLoading:ie}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"Station Information"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{onClick:()=>{F(null),J("add"),Y(!0)},className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Station"]}),0===r.length&&e.jsxs(o,{onClick:()=>window.open("/dashboard?tab=setup","_blank"),variant:"outline",size:"sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Setup Guide"]}),r.length>0&&e.jsx(b,{checked:r.length>0&&me.selectedCount===r.length,onCheckedChange:()=>me.toggleSelectAll(r,e=>e.id),"aria-label":"Select all stations"})]})]})}),e.jsx(x,{children:S?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(s=>e.jsx(h,{className:"border animate-pulse",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})})},s))}):0===r.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No Stations Configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Set up your gas stations (MOBIL, AMOCO ROSEDALE, AMOCO BROOKLYN) to get started."}),e.jsxs(o,{onClick:()=>window.open("/dashboard?tab=setup","_blank"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Go to Setup Guide"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:r.map((s,a)=>e.jsx(h,{className:"border "+(me.isSelected(s.id)?"bg-blue-50 border-blue-200":""),children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{checked:me.isSelected(s.id),onCheckedChange:()=>me.toggleItem(s.id),"aria-label":`Select station ${s.station_name}`}),e.jsx("h3",{className:"font-semibold text-lg",children:s.station_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{className:""+("Active"===s.status?"bg-green-100 text-green-800":"Inactive"===s.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:s.status}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>(e=>{F(e),J("edit"),Y(!0)})(s),className:"h-8 w-8 p-0",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>{window.confirm(`Are you sure you want to delete "${s.station_name}"?`)&&(async()=>{try{const{error:e}=await window.ezsite.apis.tableDelete(12599,{id:s.id});if(e)throw e;oe({title:"Success",description:"Station deleted successfully"}),Q.clearCache(),ge()}catch(e){console.error("Error deleting station:",e),oe({title:"Error",description:"Failed to delete station",variant:"destructive"})}})()},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(B,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx($,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.address})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.operating_hours})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Manager: ",s.manager_name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Updated: ",new Date(s.last_updated).toLocaleDateString()]})]})]})]})})},s.id||a))})})]}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:"General Settings"})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"siteName",children:"Site Name"}),e.jsx(c,{id:"siteName",value:i.siteName,onChange:e=>n({...i,siteName:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"siteDescription",children:"Site Description"}),e.jsx(c,{id:"siteDescription",value:i.siteDescription,onChange:e=>n({...i,siteDescription:e.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"maintenanceMessage",children:"Maintenance Message"}),e.jsx(v,{id:"maintenanceMessage",value:i.maintenanceMessage,onChange:e=>n({...i,maintenanceMessage:e.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"User Registration"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow new user registration"})]}),e.jsx(j,{checked:i.enableRegistration,onCheckedChange:e=>n({...i,enableRegistration:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable system notifications"})]}),e.jsx(j,{checked:i.enableNotifications,onCheckedChange:e=>n({...i,enableNotifications:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Put site in maintenance"})]}),e.jsx(j,{checked:i.enableMaintenance,onCheckedChange:e=>n({...i,enableMaintenance:e})})]})]})]})]}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{children:"Email Configuration"})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"emailFromName",children:"From Name"}),e.jsx(c,{id:"emailFromName",value:i.emailFromName,onChange:e=>n({...i,emailFromName:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"emailFromAddress",children:"From Address"}),e.jsx(c,{id:"emailFromAddress",type:"email",value:i.emailFromAddress,onChange:e=>n({...i,emailFromAddress:e.target.value})})]})]}),e.jsxs(o,{onClick:async()=>{try{const{error:e}=await window.ezsite.apis.sendEmail({from:`${i.emailFromName} <${i.emailFromAddress}>`,to:[i.emailFromAddress],subject:"DFS Manager - Email Configuration Test",html:`\n          <h2>Email Configuration Test</h2>\n          <p>This is a test email to verify your email configuration is working correctly.</p>\n          <p><strong>Site:</strong> ${i.siteName}</p>\n          <p><strong>Time:</strong> ${(new Date).toLocaleString()}</p>\n          <hr>\n          <p>If you received this email, your configuration is working properly.</p>\n        `});if(e)throw e;oe({title:"Test Email Sent",description:"Check your inbox for the test email"})}catch(e){console.error("Error sending test email:",e),oe({title:"Error",description:"Failed to send test email",variant:"destructive"})}},variant:"outline",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Send Test Email"]})]})]}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"Security Settings"})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sessionTimeout",children:"Session Timeout (minutes)"}),e.jsx(c,{id:"sessionTimeout",type:"number",value:i.sessionTimeout,onChange:e=>n({...i,sessionTimeout:parseInt(e.target.value)||30})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"passwordMinLength",children:"Password Min Length"}),e.jsx(c,{id:"passwordMinLength",type:"number",value:i.passwordMinLength,onChange:e=>n({...i,passwordMinLength:parseInt(e.target.value)||8})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"logRetentionDays",children:"Log Retention (days)"}),e.jsx(c,{id:"logRetentionDays",type:"number",value:i.logRetentionDays,onChange:e=>n({...i,logRetentionDays:parseInt(e.target.value)||30})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Password Complexity"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Require complex passwords"})]}),e.jsx(j,{checked:i.requirePasswordComplexity,onCheckedChange:e=>n({...i,requirePasswordComplexity:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable 2FA for all users"})]}),e.jsx(j,{checked:i.enableTwoFactor,onCheckedChange:e=>n({...i,enableTwoFactor:e})})]})]})]})]}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{children:"File Upload Settings"})]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"maxFileSize",children:"Max File Size (MB)"}),e.jsx(c,{id:"maxFileSize",type:"number",value:i.maxFileSize,onChange:e=>n({...i,maxFileSize:parseInt(e.target.value)||10})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"allowedFileTypes",children:"Allowed File Types"}),e.jsx(c,{id:"allowedFileTypes",value:i.allowedFileTypes,onChange:e=>n({...i,allowedFileTypes:e.target.value}),placeholder:"jpg,png,pdf,doc"})]})]})})]}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"Current Configuration"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Registration"}),e.jsx(p,{className:pe(i.enableRegistration),children:i.enableRegistration?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Notifications"}),e.jsx(p,{className:pe(i.enableNotifications),children:i.enableNotifications?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Maintenance"}),e.jsx(p,{className:pe(i.enableMaintenance),children:i.enableMaintenance?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Two-Factor"}),e.jsx(p,{className:pe(i.enableTwoFactor),children:i.enableTwoFactor?"Required":"Optional"})]})]})})]}),e.jsx(X,{open:D,onOpenChange:Y,station:_,onSave:ue,mode:Z}),e.jsx(W,{open:M,onOpenChange:A,station:_,onSave:ue}),e.jsx(f,{isOpen:ee,onClose:()=>se(!1),onSave:async()=>{ne(!0);try{const e=me.getSelectedData(r,e=>e.id),s=e.map(e=>({id:e.id,...he.status&&{status:he.status},...he.manager_name&&{manager_name:he.manager_name},...he.operating_hours&&{operating_hours:he.operating_hours},last_updated:(new Date).toISOString()}));for(const a of s){const{error:e}=await window.ezsite.apis.tableUpdate(12599,a);if(e)throw e}oe({title:"Success",description:`Updated ${e.length} stations successfully`}),se(!1),me.clearSelection(),Q.clearCache(),ge()}catch(e){console.error("Error in batch edit:",e),oe({title:"Error",description:`Failed to update stations: ${e}`,variant:"destructive"})}finally{ne(!1)}},selectedCount:me.selectedCount,isLoading:ie,itemName:"stations",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"batch_status",children:"Status"}),e.jsxs("select",{id:"batch_status",value:he.status,onChange:e=>xe({...he,status:e.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Keep existing status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"batch_manager",children:"Manager Name"}),e.jsx(c,{id:"batch_manager",value:he.manager_name,onChange:e=>xe({...he,manager_name:e.target.value}),placeholder:"Leave empty to keep existing managers"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"batch_hours",children:"Operating Hours"}),e.jsx(c,{id:"batch_hours",value:he.operating_hours,onChange:e=>xe({...he,operating_hours:e.target.value}),placeholder:"Leave empty to keep existing hours"})]})]})}),e.jsx(w,{isOpen:ae,onClose:()=>te(!1),onConfirm:async()=>{ne(!0);try{const e=me.getSelectedData(r,e=>e.id);for(const s of e){const{error:e}=await window.ezsite.apis.tableDelete(12599,{id:s.id});if(e)throw e}oe({title:"Success",description:`Deleted ${e.length} stations successfully`}),te(!1),me.clearSelection(),Q.clearCache(),ge()}catch(e){console.error("Error in batch delete:",e),oe({title:"Error",description:`Failed to delete stations: ${e}`,variant:"destructive"})}finally{ne(!1)}},selectedCount:me.selectedCount,isLoading:ie,itemName:"stations",selectedItems:me.getSelectedData(r,e=>e.id).map(e=>({id:e.id,name:e.station_name}))})]}):e.jsx(K,{feature:"Site Management",requiredRole:"Administrator"})};export{Y as default};
