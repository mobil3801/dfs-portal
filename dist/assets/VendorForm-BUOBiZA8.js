import{j as e}from"./radix-ui-BhRELLXi.js";import{r as s}from"./react-core-CKNU0hQt.js";import{t as a,C as t,g as r,h as n,l as i,f as c,i as l,L as o,I as d}from"./index-s81fdLZV.js";import{T as m}from"./textarea-BmFJKjYW.js";import{S as h,c as p,d as x,a as v,b as j}from"./select-CiDiYLaC.js";import{S as u}from"./switch-BZeuVaev.js";import{S as y}from"./StationDropdown-D7v0Pmwq.js";import{u as g,d as f}from"./routing-DcURAnU1.js";import{a8 as N,G as S,N as _}from"./utilities-DVevn_gw.js";import"./data-management-CF8GQrOz.js";import"./animations-Cc9qW4PM.js";import"./use-station-service-rOm4NM0m.js";import"./stationService-CEciqnCB.js";const b=()=>{const[b,w]=s.useState({vendor_name:"",contact_person:"",email:"",phone:"",address:"",category:"",payment_terms:"",is_active:!0,station:""}),[C,F]=s.useState(!1),[E,V]=s.useState(!1),[A,P]=s.useState(""),L=g(),{id:k}=f();s.useEffect(()=>{k&&(V(!0),I(parseInt(k)))},[k]);const I=async e=>{try{F(!0);const{data:s,error:a}=await window.ezsite.apis.tablePage("11729",{PageNo:1,PageSize:1,Filters:[{name:"ID",op:"Equal",value:e}]});if(a)throw a;if(s&&s.List&&s.List.length>0){const e=s.List[0];w({vendor_name:e.vendor_name||"",contact_person:e.contact_person||"",email:e.email||"",phone:e.phone||"",address:e.address||"",category:e.category||"",payment_terms:e.payment_terms||"",is_active:!1!==e.is_active,station:e.station||""}),P(e.station||"")}}catch(s){console.error("Error loading vendor:",s),a({title:"Error",description:"Failed to load vendor details",variant:"destructive"})}finally{F(!1)}},z=(e,s)=>{w(a=>({...a,[e]:s}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"w-6 h-6"}),e.jsx("span",{children:E?"Edit Vendor":"Add New Vendor"})]}),e.jsx(i,{children:E?"Update vendor information":"Add a new vendor to your contacts"})]}),e.jsxs(c,{variant:"outline",onClick:()=>L("/vendors"),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Back to Vendors"]})]})}),e.jsx(l,{children:A||E?e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{F(!0);const e={...b,station:A,created_by:1};if(E&&k){const{error:s}=await window.ezsite.apis.tableUpdate("11729",{ID:parseInt(k),...e});if(s)throw s;a({title:"Success",description:"Vendor updated successfully"})}else{const{error:s}=await window.ezsite.apis.tableCreate("11729",e);if(s)throw s;a({title:"Success",description:"Vendor created successfully"})}L("/vendors")}catch(s){console.error("Error saving vendor:",s),a({title:"Error",description:`Failed to ${E?"update":"create"} vendor`,variant:"destructive"})}finally{F(!1)}},className:"space-y-6",children:[A&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Selected Station"}),e.jsxs("p",{className:"text-blue-700",children:["ALL"===A?"All Stations":A,"ALL"===A&&e.jsx("span",{className:"text-sm text-blue-600 ml-2",children:"(Multi-station vendor)"})]})]}),!E&&e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:()=>P(""),children:"Change Station"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"vendor_name",children:"Vendor Name *"}),e.jsx(d,{id:"vendor_name",value:b.vendor_name,onChange:e=>z("vendor_name",e.target.value),placeholder:"Enter vendor company name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"contact_person",children:"Contact Person *"}),e.jsx(d,{id:"contact_person",value:b.contact_person,onChange:e=>z("contact_person",e.target.value),placeholder:"Enter primary contact name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"email",children:"Email Address"}),e.jsx(d,{id:"email",type:"email",value:b.email,onChange:e=>z("email",e.target.value),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"phone",children:"Phone Number"}),e.jsx(d,{id:"phone",value:b.phone,onChange:e=>z("phone",e.target.value),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"category",children:"Category *"}),e.jsxs(h,{value:b.category,onValueChange:e=>z("category",e),children:[e.jsx(p,{children:e.jsx(x,{placeholder:"Select vendor category"})}),e.jsx(v,{children:["Fuel Supplier","Food & Beverages","Automotive","Maintenance","Office Supplies","Technology","Cleaning Services","Security Services","Other"].map(s=>e.jsx(j,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"payment_terms",children:"Payment Terms"}),e.jsxs(h,{value:b.payment_terms,onValueChange:e=>z("payment_terms",e),children:[e.jsx(p,{children:e.jsx(x,{placeholder:"Select payment terms"})}),e.jsx(v,{children:["Net 30","Net 15","Payment on Delivery","Prepaid","2/10 Net 30","Custom Terms"].map(s=>e.jsx(j,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"address",children:"Address"}),e.jsx(m,{id:"address",value:b.address,onChange:e=>z("address",e.target.value),placeholder:"Enter full business address",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"is_active",children:"Active Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{id:"is_active",checked:b.is_active,onCheckedChange:e=>z("is_active",e)}),e.jsx("span",{className:"text-sm text-gray-600",children:b.is_active?"Active vendor":"Inactive vendor"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>L("/vendors"),children:"Cancel"}),e.jsx(c,{type:"submit",disabled:C,children:C?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),E?"Update Vendor":"Create Vendor"]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Select Station First"}),e.jsx("p",{className:"text-gray-600",children:"Please select a station before creating a vendor."})]}),e.jsx("div",{className:"max-w-md mx-auto space-y-4",children:e.jsx(y,{id:"station",label:"Station",value:A,onValueChange:e=>{P(e),w(s=>({...s,station:e}))},placeholder:"Select a station",required:!0,includeAll:!0})})]})})]})})};export{b as default};
