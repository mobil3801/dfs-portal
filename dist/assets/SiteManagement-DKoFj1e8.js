import{j as e}from"./radix-ui-BhRELLXi.js";import{r as s}from"./react-core-CKNU0hQt.js";import{n as a,L as t,I as i,f as n,v as r,C as l,i as c,g as d,h as o,B as m}from"./index-s81fdLZV.js";import{S as h}from"./switch-BZeuVaev.js";import{T as x}from"./textarea-BmFJKjYW.js";import{u as g,B as u,C as p,a as j}from"./BatchDeleteDialog-DlNmvodk.js";import{B as v}from"./BatchEditDialog-DnEgf8QL.js";import{D as N,a as y,b,c as f,f as w}from"./dialog-DoXR3LdX.js";import{S,c as C,d as _,a as F,b as M}from"./select-CiDiYLaC.js";import{x as A,a8 as E,X as D,N as k,S as O,R as T,e as I,ax as L,r as q,d as z,Q as R,W as P,O as B,aa as $,a5 as U,m as G,a9 as H,ad as K}from"./utilities-DVevn_gw.js";import{A as V}from"./AccessDenied-wxYpicIE.js";import{s as W}from"./stationService-CEciqnCB.js";import"./routing-DcURAnU1.js";import"./data-management-CF8GQrOz.js";import"./animations-Cc9qW4PM.js";function Q({open:r,onOpenChange:l,station:c,onSave:d}){const{toast:o}=a(),[m,h]=s.useState(!1),[x,g]=s.useState({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"});s.useEffect(()=>{c&&g({station_name:c.station_name,address:c.address,phone:c.phone,operating_hours:c.operating_hours,manager_name:c.manager_name,status:c.status})},[c]);const u=(e,s)=>{g(a=>({...a,[e]:s}))},p=x.station_name&&x.address&&x.phone&&x.operating_hours&&x.manager_name;return e.jsx(N,{open:r,onOpenChange:l,children:e.jsxs(y,{className:"sm:max-w-[500px]",children:[e.jsx(b,{children:e.jsx(f,{children:"Edit Station Information"})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),c){h(!0);try{console.log("Updating station:",c.id,x);const e={id:c.id,...x,last_updated:(new Date).toISOString(),created_by:c.created_by},{error:s}=await window.ezsite.apis.tableUpdate(12599,e);if(s)throw s;o({title:"Success",description:"Station information updated successfully"}),d(),l(!1)}catch(s){console.error("Error updating station:",s),o({title:"Error",description:s?.toString()||"Failed to update station information",variant:"destructive"})}finally{h(!1)}}},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"station_name",children:"Station Name"}),e.jsx(i,{id:"station_name",value:x.station_name,onChange:e=>u("station_name",e.target.value),placeholder:"Enter station name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"address",children:"Address"}),e.jsx(i,{id:"address",value:x.address,onChange:e=>u("address",e.target.value),placeholder:"Enter station address",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"phone",children:"Phone Number"}),e.jsx(i,{id:"phone",value:x.phone,onChange:e=>u("phone",e.target.value),placeholder:"(718) 555-0100",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"status",children:"Status"}),e.jsxs(S,{value:x.status,onValueChange:e=>u("status",e),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsxs(F,{children:[e.jsx(M,{value:"Active",children:"Active"}),e.jsx(M,{value:"Inactive",children:"Inactive"}),e.jsx(M,{value:"Maintenance",children:"Maintenance"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"operating_hours",children:"Operating Hours"}),e.jsx(i,{id:"operating_hours",value:x.operating_hours,onChange:e=>u("operating_hours",e.target.value),placeholder:"24/7 or 6:00 AM - 12:00 AM",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"manager_name",children:"Manager Name"}),e.jsx(i,{id:"manager_name",value:x.manager_name,onChange:e=>u("manager_name",e.target.value),placeholder:"Enter manager name",required:!0})]})]}),e.jsxs(w,{className:"gap-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:m||!p,className:"min-w-[100px]",children:m?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})]})})}const Y=({open:r,onOpenChange:l,station:c,onSave:d,mode:o})=>{const{toast:m}=a(),[h,g]=s.useState(!1),[u,p]=s.useState({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"});s.useEffect(()=>{c&&"edit"===o?p({id:c.id,station_name:c.station_name||"",address:c.address||"",phone:c.phone||"",operating_hours:c.operating_hours||"",manager_name:c.manager_name||"",status:c.status||"Active"}):"add"===o&&p({station_name:"",address:"",phone:"",operating_hours:"",manager_name:"",status:"Active"})},[c,o,r]);const j=()=>{h||l(!1)};return e.jsx(N,{open:r,onOpenChange:j,children:e.jsxs(y,{className:"sm:max-w-md",children:[e.jsx(b,{children:e.jsxs(f,{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"add"===o?"Add New Station":"Edit Station"})]})}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),g(!0);try{if(!u.station_name.trim())throw new Error("Station name is required");if(!u.address.trim())throw new Error("Address is required");if(!u.phone.trim())throw new Error("Phone number is required");if(!u.operating_hours.trim())throw new Error("Operating hours are required");if(!u.manager_name.trim())throw new Error("Manager name is required");const e={...u,last_updated:(new Date).toISOString(),created_by:1};if("add"===o){const{error:s}=await window.ezsite.apis.tableCreate(12599,e);if(s)throw s;m({title:"Success",description:"Station added successfully"})}else{const{error:s}=await window.ezsite.apis.tableUpdate(12599,e);if(s)throw s;m({title:"Success",description:"Station updated successfully"})}d(),l(!1)}catch(s){console.error("Error saving station:",s),m({title:"Error",description:"string"==typeof s?s:"Failed to save station",variant:"destructive"})}finally{g(!1)}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"station_name",children:"Station Name *"}),e.jsx(i,{id:"station_name",value:u.station_name,onChange:e=>p({...u,station_name:e.target.value}),placeholder:"e.g., MOBIL, AMOCO ROSEDALE",required:!0})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"address",children:"Address *"}),e.jsx(x,{id:"address",value:u.address,onChange:e=>p({...u,address:e.target.value}),placeholder:"Full station address",required:!0,rows:2})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(i,{id:"phone",type:"tel",value:u.phone,onChange:e=>p({...u,phone:e.target.value}),placeholder:"(555) 123-4567",required:!0})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"operating_hours",children:"Operating Hours *"}),e.jsx(i,{id:"operating_hours",value:u.operating_hours,onChange:e=>p({...u,operating_hours:e.target.value}),placeholder:"e.g., 24/7 or 6:00 AM - 12:00 AM",required:!0})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"manager_name",children:"Manager Name *"}),e.jsx(i,{id:"manager_name",value:u.manager_name,onChange:e=>p({...u,manager_name:e.target.value}),placeholder:"Station manager name",required:!0})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"status",children:"Status"}),e.jsxs(S,{value:u.status,onValueChange:e=>p({...u,status:e}),children:[e.jsx(C,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsxs(F,{children:[e.jsx(M,{value:"Active",children:"Active"}),e.jsx(M,{value:"Inactive",children:"Inactive"}),e.jsx(M,{value:"Maintenance",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsxs(n,{type:"button",variant:"outline",onClick:j,disabled:h,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{type:"submit",disabled:h,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),h?"Saving...":"add"===o?"Add Station":"Update Station"]})]})]})]})})},J=()=>{const{isAdmin:N}=r(),[y,b]=s.useState({siteName:"DFS Manager Portal",siteDescription:"Comprehensive gas station management system",enableRegistration:!1,enableNotifications:!0,enableMaintenance:!1,maintenanceMessage:"System is under maintenance. Please check back later.",emailFromAddress:"support@ezsite.ai",emailFromName:"DFS Manager Support",maxFileSize:10,allowedFileTypes:"jpg,jpeg,png,pdf,doc,docx,xls,xlsx",sessionTimeout:30,passwordMinLength:8,requirePasswordComplexity:!0,enableTwoFactor:!1,backupFrequency:"daily",logRetentionDays:30}),[f,w]=s.useState([]),[S,C]=s.useState(!0),[_,F]=s.useState(null),[M,A]=s.useState(!1),[D,J]=s.useState(!1),[X,Z]=s.useState("add"),[ee,se]=s.useState(!1),[ae,te]=s.useState(!1),[ie,ne]=s.useState(!1),[re,le]=s.useState(!1),[ce,de]=s.useState(!1),{toast:oe}=a(),me=g(),[he,xe]=s.useState({status:"",manager_name:"",operating_hours:""}),ge=async()=>{try{console.log("Loading stations from centralized service...");const{data:e,error:s}=await window.ezsite.apis.tablePage(12599,{PageNo:1,PageSize:100,OrderByField:"station_name",IsAsc:!0,Filters:[]});if(s)throw s;console.log("Loaded stations:",e),w(e?.List||[])}catch(e){console.error("Error loading stations:",e),oe({title:"Error",description:"Failed to load station information",variant:"destructive"})}finally{C(!1)}};s.useEffect(()=>{ge()},[]);const ue=()=>{W.clearCache(),ge()},pe=e=>e?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return N?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(O,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Site Management"})]}),e.jsx(n,{onClick:async()=>{de(!0);try{await new Promise(e=>setTimeout(e,1e3)),oe({title:"Success",description:"Site settings saved successfully"})}catch(e){console.error("Error saving settings:",e),oe({title:"Error",description:"Failed to save settings",variant:"destructive"})}finally{de(!1)}},disabled:ce,className:"bg-blue-600 hover:bg-blue-700",children:ce?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"System Status"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:"Online"})]})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Database"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:"Connected"})]})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email Service"}),e.jsx("p",{className:"text-lg font-semibold text-purple-600",children:"Active"})]})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Security"}),e.jsx("p",{className:"text-lg font-semibold text-orange-600",children:"Protected"})]})]})})})]}),e.jsx(u,{selectedCount:me.selectedCount,onBatchEdit:()=>{0!==me.getSelectedData(f,e=>e.id).length?se(!0):oe({title:"No Selection",description:"Please select stations to edit",variant:"destructive"})},onBatchDelete:()=>{0!==me.getSelectedData(f,e=>e.id).length?te(!0):oe({title:"No Selection",description:"Please select stations to delete",variant:"destructive"})},onClearSelection:me.clearSelection,isLoading:ie}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"Station Information"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{onClick:()=>{F(null),Z("add"),J(!0)},className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Add Station"]}),0===f.length&&e.jsxs(n,{onClick:()=>window.open("/dashboard?tab=setup","_blank"),variant:"outline",size:"sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Setup Guide"]}),f.length>0&&e.jsx(p,{checked:f.length>0&&me.selectedCount===f.length,onCheckedChange:()=>me.toggleSelectAll(f,e=>e.id),"aria-label":"Select all stations"})]})]})}),e.jsx(c,{children:S?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(s=>e.jsx(l,{className:"border animate-pulse",children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})})},s))}):0===f.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No Stations Configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Set up your gas stations (MOBIL, AMOCO ROSEDALE, AMOCO BROOKLYN) to get started."}),e.jsxs(n,{onClick:()=>window.open("/dashboard?tab=setup","_blank"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Go to Setup Guide"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f.map((s,a)=>e.jsx(l,{className:"border "+(me.isSelected(s.id)?"bg-blue-50 border-blue-200":""),children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{checked:me.isSelected(s.id),onCheckedChange:()=>me.toggleItem(s.id),"aria-label":`Select station ${s.station_name}`}),e.jsx("h3",{className:"font-semibold text-lg",children:s.station_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{className:""+("Active"===s.status?"bg-green-100 text-green-800":"Inactive"===s.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:s.status}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>(e=>{console.log("Editing station:",e),F(e),Z("edit"),J(!0)})(s),className:"h-8 w-8 p-0",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>{window.confirm(`Are you sure you want to delete "${s.station_name}"?`)&&(async()=>{try{const{error:e}=await window.ezsite.apis.tableDelete(12599,{id:s.id});if(e)throw e;oe({title:"Success",description:"Station deleted successfully"}),W.clearCache(),ge()}catch(e){console.error("Error deleting station:",e),oe({title:"Error",description:"Failed to delete station",variant:"destructive"})}})()},className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(B,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx($,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.address})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.operating_hours})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Manager: ",s.manager_name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Updated: ",new Date(s.last_updated).toLocaleDateString()]})]})]})]})})},s.id||a))})})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:"General Settings"})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"siteName",children:"Site Name"}),e.jsx(i,{id:"siteName",value:y.siteName,onChange:e=>b({...y,siteName:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"siteDescription",children:"Site Description"}),e.jsx(i,{id:"siteDescription",value:y.siteDescription,onChange:e=>b({...y,siteDescription:e.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"maintenanceMessage",children:"Maintenance Message"}),e.jsx(x,{id:"maintenanceMessage",value:y.maintenanceMessage,onChange:e=>b({...y,maintenanceMessage:e.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(t,{children:"User Registration"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow new user registration"})]}),e.jsx(h,{checked:y.enableRegistration,onCheckedChange:e=>b({...y,enableRegistration:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable system notifications"})]}),e.jsx(h,{checked:y.enableNotifications,onCheckedChange:e=>b({...y,enableNotifications:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Put site in maintenance"})]}),e.jsx(h,{checked:y.enableMaintenance,onCheckedChange:e=>b({...y,enableMaintenance:e})})]})]})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{children:"Email Configuration"})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"emailFromName",children:"From Name"}),e.jsx(i,{id:"emailFromName",value:y.emailFromName,onChange:e=>b({...y,emailFromName:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"emailFromAddress",children:"From Address"}),e.jsx(i,{id:"emailFromAddress",type:"email",value:y.emailFromAddress,onChange:e=>b({...y,emailFromAddress:e.target.value})})]})]}),e.jsxs(n,{onClick:async()=>{try{const{error:e}=await window.ezsite.apis.sendEmail({from:`${y.emailFromName} <${y.emailFromAddress}>`,to:[y.emailFromAddress],subject:"DFS Manager - Email Configuration Test",html:`\n          <h2>Email Configuration Test</h2>\n          <p>This is a test email to verify your email configuration is working correctly.</p>\n          <p><strong>Site:</strong> ${y.siteName}</p>\n          <p><strong>Time:</strong> ${(new Date).toLocaleString()}</p>\n          <hr>\n          <p>If you received this email, your configuration is working properly.</p>\n        `});if(e)throw e;oe({title:"Test Email Sent",description:"Check your inbox for the test email"})}catch(e){console.error("Error sending test email:",e),oe({title:"Error",description:"Failed to send test email",variant:"destructive"})}},variant:"outline",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Send Test Email"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{children:"Security Settings"})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"sessionTimeout",children:"Session Timeout (minutes)"}),e.jsx(i,{id:"sessionTimeout",type:"number",value:y.sessionTimeout,onChange:e=>b({...y,sessionTimeout:parseInt(e.target.value)||30})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"passwordMinLength",children:"Password Min Length"}),e.jsx(i,{id:"passwordMinLength",type:"number",value:y.passwordMinLength,onChange:e=>b({...y,passwordMinLength:parseInt(e.target.value)||8})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"logRetentionDays",children:"Log Retention (days)"}),e.jsx(i,{id:"logRetentionDays",type:"number",value:y.logRetentionDays,onChange:e=>b({...y,logRetentionDays:parseInt(e.target.value)||30})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Password Complexity"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Require complex passwords"})]}),e.jsx(h,{checked:y.requirePasswordComplexity,onCheckedChange:e=>b({...y,requirePasswordComplexity:e})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable 2FA for all users"})]}),e.jsx(h,{checked:y.enableTwoFactor,onCheckedChange:e=>b({...y,enableTwoFactor:e})})]})]})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"File Upload Settings"})]})}),e.jsx(c,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"maxFileSize",children:"Max File Size (MB)"}),e.jsx(i,{id:"maxFileSize",type:"number",value:y.maxFileSize,onChange:e=>b({...y,maxFileSize:parseInt(e.target.value)||10})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"allowedFileTypes",children:"Allowed File Types"}),e.jsx(i,{id:"allowedFileTypes",value:y.allowedFileTypes,onChange:e=>b({...y,allowedFileTypes:e.target.value}),placeholder:"jpg,png,pdf,doc"})]})]})})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{children:"Current Configuration"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Registration"}),e.jsx(m,{className:pe(y.enableRegistration),children:y.enableRegistration?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Notifications"}),e.jsx(m,{className:pe(y.enableNotifications),children:y.enableNotifications?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Maintenance"}),e.jsx(m,{className:pe(y.enableMaintenance),children:y.enableMaintenance?"Active":"Inactive"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Two-Factor"}),e.jsx(m,{className:pe(y.enableTwoFactor),children:y.enableTwoFactor?"Required":"Optional"})]})]})})]}),e.jsx(Y,{open:D,onOpenChange:J,station:_,onSave:ue,mode:X}),e.jsx(Q,{open:M,onOpenChange:A,station:_,onSave:ue}),e.jsx(v,{isOpen:ee,onClose:()=>se(!1),onSave:async()=>{ne(!0);try{const e=me.getSelectedData(f,e=>e.id),s=e.map(e=>({id:e.id,...he.status&&{status:he.status},...he.manager_name&&{manager_name:he.manager_name},...he.operating_hours&&{operating_hours:he.operating_hours},last_updated:(new Date).toISOString()}));for(const a of s){const{error:e}=await window.ezsite.apis.tableUpdate(12599,a);if(e)throw e}oe({title:"Success",description:`Updated ${e.length} stations successfully`}),se(!1),me.clearSelection(),W.clearCache(),ge()}catch(e){console.error("Error in batch edit:",e),oe({title:"Error",description:`Failed to update stations: ${e}`,variant:"destructive"})}finally{ne(!1)}},selectedCount:me.selectedCount,isLoading:ie,itemName:"stations",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"batch_status",children:"Status"}),e.jsxs("select",{id:"batch_status",value:he.status,onChange:e=>xe({...he,status:e.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"",children:"Keep existing status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"batch_manager",children:"Manager Name"}),e.jsx(i,{id:"batch_manager",value:he.manager_name,onChange:e=>xe({...he,manager_name:e.target.value}),placeholder:"Leave empty to keep existing managers"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"batch_hours",children:"Operating Hours"}),e.jsx(i,{id:"batch_hours",value:he.operating_hours,onChange:e=>xe({...he,operating_hours:e.target.value}),placeholder:"Leave empty to keep existing hours"})]})]})}),e.jsx(j,{isOpen:ae,onClose:()=>te(!1),onConfirm:async()=>{ne(!0);try{const e=me.getSelectedData(f,e=>e.id);for(const s of e){const{error:e}=await window.ezsite.apis.tableDelete(12599,{id:s.id});if(e)throw e}oe({title:"Success",description:`Deleted ${e.length} stations successfully`}),te(!1),me.clearSelection(),W.clearCache(),ge()}catch(e){console.error("Error in batch delete:",e),oe({title:"Error",description:`Failed to delete stations: ${e}`,variant:"destructive"})}finally{ne(!1)}},selectedCount:me.selectedCount,isLoading:ie,itemName:"stations",selectedItems:me.getSelectedData(f,e=>e.id).map(e=>({id:e.id,name:e.station_name}))})]}):e.jsx(V,{feature:"Site Management",requiredRole:"Administrator"})};export{J as default};
