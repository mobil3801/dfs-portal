import{j as e}from"./radix-ui-woSLwCdF.js";import{r as s}from"./react-core-CKNU0hQt.js";import{v as t,l as i,e as r,C as c,h as a,f as l,g as n,L as d,I as o,B as x}from"./index-CIZJQuMw.js";import{S as m}from"./switch-C1qVBy4u.js";import{T as u,a as h,b as p,c as y,d as j,e as g}from"./table-vnZa3hwR.js";import{u as v,B as S,C as w,a as N}from"./BatchDeleteDialog-CSYMbd-n.js";import{A as b}from"./AccessDenied-DixbFBF5.js";import{g as f,R as C,Q as k,C as P,T as E,b as A,l as q,w as F,aF as D,aG as I,aE as L,f as T}from"./utilities-DMEd7dY0.js";import"./routing-DcURAnU1.js";import"./data-management-r38r-ocq.js";import"./animations-CdlE0-Ca.js";const R=()=>{const{isAdmin:R}=t(),[U,_]=s.useState({passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!0,passwordExpiry:90,preventReuse:12},accountSecurity:{maxFailedAttempts:5,lockoutDuration:30,requireEmailVerification:!0,requireTwoFactor:!1,sessionTimeout:60,allowMultipleSessions:!1},systemSecurity:{enableSSL:!0,enableFirewall:!0,enableIPWhitelist:!1,ipWhitelist:["192.168.1.0/24"],enableAuditLogging:!0,enableDataEncryption:!0,enableBackupEncryption:!0},accessControl:{enableRoleBasedAccess:!0,requireApprovalForNewUsers:!0,defaultUserRole:"Employee",enableGuestAccess:!1,maxConcurrentUsers:50}}),[W,B]=s.useState([]),[O,M]=s.useState(""),[$,V]=s.useState(!1),[G,z]=s.useState(!1),[Q,X]=s.useState(!1),{toast:H}=i(),J=v();s.useEffect(()=>{K()},[]);const K=()=>{const e=[{id:"1",timestamp:(new Date).toISOString(),type:"login_failure",severity:"medium",user:"unknown",ip_address:"203.0.113.10",description:"5 consecutive failed login attempts",action_taken:"IP temporarily blocked"},{id:"2",timestamp:new Date(Date.now()-3e5).toISOString(),type:"suspicious_activity",severity:"high",user:"admin@dfsmanager.com",ip_address:"198.51.100.15",description:"Login from unusual geographic location",action_taken:"Email alert sent to user"},{id:"3",timestamp:new Date(Date.now()-6e5).toISOString(),type:"policy_violation",severity:"low",user:"employee@dfsmanager.com",description:"Password does not meet complexity requirements",action_taken:"User prompted to update password"},{id:"4",timestamp:new Date(Date.now()-18e5).toISOString(),type:"security_breach",severity:"critical",description:"Unauthorized API access attempt detected",action_taken:"System locked, admin notified"}];B(e)},Y=e=>{switch(e){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Z=(()=>{let e=0;return U.passwordPolicy.minLength>=8&&e++,U.passwordPolicy.requireUppercase&&e++,U.passwordPolicy.requireNumbers&&e++,U.passwordPolicy.requireSpecialChars&&e++,U.passwordPolicy.passwordExpiry<=90&&e++,U.accountSecurity.maxFailedAttempts<=5&&e++,U.accountSecurity.requireEmailVerification&&e++,U.accountSecurity.requireTwoFactor&&(e+=2),U.accountSecurity.sessionTimeout<=60&&e++,U.systemSecurity.enableSSL&&(e+=2),U.systemSecurity.enableFirewall&&(e+=2),U.systemSecurity.enableAuditLogging&&e++,U.systemSecurity.enableDataEncryption&&(e+=2),U.systemSecurity.enableBackupEncryption&&e++,U.accessControl.enableRoleBasedAccess&&e++,U.accessControl.requireApprovalForNewUsers&&e++,Math.round(e/20*100)})();return R?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(f,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Security Settings"})]}),e.jsx(r,{onClick:async()=>{V(!0);try{await new Promise(e=>setTimeout(e,1e3)),H({title:"Success",description:"Security settings saved successfully"})}catch(e){console.error("Error saving settings:",e),H({title:"Error",description:"Failed to save security settings",variant:"destructive"})}finally{V(!1)}},disabled:$,className:"bg-blue-600 hover:bg-blue-700",children:$?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})]}),e.jsx(c,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security Score"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overall security posture assessment"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[Z,"%"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[Z>=80?e.jsx(P,{className:"w-4 h-4 text-green-500"}):Z>=60?e.jsx(E,{className:"w-4 h-4 text-yellow-500"}):e.jsx(A,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:Z>=80?"Excellent":Z>=60?"Good":"Needs Improvement"})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(c,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(f,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Protections"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"12"})]})]})})}),e.jsx(c,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Security Events"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:W.length})]})]})})}),e.jsx(c,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"3"})]})]})})}),e.jsx(c,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Failed Attempts"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"2"})]})]})})})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{children:"Password Policy"})]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"minLength",children:"Minimum Length"}),e.jsx(o,{id:"minLength",type:"number",value:U.passwordPolicy.minLength,onChange:e=>_(s=>({...s,passwordPolicy:{...s.passwordPolicy,minLength:parseInt(e.target.value)||8}}))})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"passwordExpiry",children:"Password Expiry (days)"}),e.jsx(o,{id:"passwordExpiry",type:"number",value:U.passwordPolicy.passwordExpiry,onChange:e=>_(s=>({...s,passwordPolicy:{...s.passwordPolicy,passwordExpiry:parseInt(e.target.value)||90}}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Require Uppercase"}),e.jsx("p",{className:"text-sm text-gray-500",children:"At least one uppercase letter"})]}),e.jsx(m,{checked:U.passwordPolicy.requireUppercase,onCheckedChange:e=>_(s=>({...s,passwordPolicy:{...s.passwordPolicy,requireUppercase:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Require Numbers"}),e.jsx("p",{className:"text-sm text-gray-500",children:"At least one number"})]}),e.jsx(m,{checked:U.passwordPolicy.requireNumbers,onCheckedChange:e=>_(s=>({...s,passwordPolicy:{...s.passwordPolicy,requireNumbers:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Require Special Characters"}),e.jsx("p",{className:"text-sm text-gray-500",children:"At least one special character"})]}),e.jsx(m,{checked:U.passwordPolicy.requireSpecialChars,onCheckedChange:e=>_(s=>({...s,passwordPolicy:{...s.passwordPolicy,requireSpecialChars:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Require Lowercase"}),e.jsx("p",{className:"text-sm text-gray-500",children:"At least one lowercase letter"})]}),e.jsx(m,{checked:U.passwordPolicy.requireLowercase,onCheckedChange:e=>_(s=>({...s,passwordPolicy:{...s.passwordPolicy,requireLowercase:e}}))})]})]})]})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"w-5 h-5"}),e.jsx("span",{children:"Account Security"})]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"maxFailedAttempts",children:"Max Failed Attempts"}),e.jsx(o,{id:"maxFailedAttempts",type:"number",value:U.accountSecurity.maxFailedAttempts,onChange:e=>_(s=>({...s,accountSecurity:{...s.accountSecurity,maxFailedAttempts:parseInt(e.target.value)||5}}))})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"lockoutDuration",children:"Lockout Duration (minutes)"}),e.jsx(o,{id:"lockoutDuration",type:"number",value:U.accountSecurity.lockoutDuration,onChange:e=>_(s=>({...s,accountSecurity:{...s.accountSecurity,lockoutDuration:parseInt(e.target.value)||30}}))})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"sessionTimeout",children:"Session Timeout (minutes)"}),e.jsx(o,{id:"sessionTimeout",type:"number",value:U.accountSecurity.sessionTimeout,onChange:e=>_(s=>({...s,accountSecurity:{...s.accountSecurity,sessionTimeout:parseInt(e.target.value)||60}}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Email Verification"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Require email verification for new accounts"})]}),e.jsx(m,{checked:U.accountSecurity.requireEmailVerification,onCheckedChange:e=>_(s=>({...s,accountSecurity:{...s.accountSecurity,requireEmailVerification:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Require 2FA for all users"})]}),e.jsx(m,{checked:U.accountSecurity.requireTwoFactor,onCheckedChange:e=>_(s=>({...s,accountSecurity:{...s.accountSecurity,requireTwoFactor:e}}))})]})]})]})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:"System Security"})]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"SSL/TLS Encryption"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable secure connections"})]}),e.jsx(m,{checked:U.systemSecurity.enableSSL,onCheckedChange:e=>_(s=>({...s,systemSecurity:{...s.systemSecurity,enableSSL:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Firewall Protection"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable network firewall"})]}),e.jsx(m,{checked:U.systemSecurity.enableFirewall,onCheckedChange:e=>_(s=>({...s,systemSecurity:{...s.systemSecurity,enableFirewall:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Audit Logging"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Log all system activities"})]}),e.jsx(m,{checked:U.systemSecurity.enableAuditLogging,onCheckedChange:e=>_(s=>({...s,systemSecurity:{...s.systemSecurity,enableAuditLogging:e}}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Data Encryption"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Encrypt stored data"})]}),e.jsx(m,{checked:U.systemSecurity.enableDataEncryption,onCheckedChange:e=>_(s=>({...s,systemSecurity:{...s.systemSecurity,enableDataEncryption:e}}))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Backup Encryption"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Encrypt backup files"})]}),e.jsx(m,{checked:U.systemSecurity.enableBackupEncryption,onCheckedChange:e=>_(s=>({...s,systemSecurity:{...s.systemSecurity,enableBackupEncryption:e}}))})]})]})]})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"IP Address Management"})]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Enable IP Whitelist"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Only allow access from specified IP addresses"})]}),e.jsx(m,{checked:U.systemSecurity.enableIPWhitelist,onCheckedChange:e=>_(s=>({...s,systemSecurity:{...s.systemSecurity,enableIPWhitelist:e}}))})]}),U.systemSecurity.enableIPWhitelist&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(o,{placeholder:"Enter IP address or CIDR (e.g., 192.168.1.0/24)",value:O,onChange:e=>M(e.target.value)}),e.jsx(r,{onClick:()=>{O&&!U.systemSecurity.ipWhitelist.includes(O)&&(_(e=>({...e,systemSecurity:{...e.systemSecurity,ipWhitelist:[...e.systemSecurity.ipWhitelist,O]}})),M(""),H({title:"IP Added",description:"IP address added to whitelist"}))},children:"Add"})]}),e.jsx("div",{className:"space-y-2",children:U.systemSecurity.ipWhitelist.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsx("span",{className:"font-mono text-sm",children:s}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>(e=>{_(s=>({...s,systemSecurity:{...s.systemSecurity,ipWhitelist:s.systemSecurity.ipWhitelist.filter(s=>s!==e)}})),H({title:"IP Removed",description:"IP address removed from whitelist"})})(s),className:"text-red-600",children:"Remove"})]},t))})]})]})]}),e.jsx(S,{selectedCount:J.selectedCount,onBatchDelete:()=>{0!==J.getSelectedData(W,e=>e.id).length?z(!0):H({title:"No Selection",description:"Please select security events to delete",variant:"destructive"})},onClearSelection:J.clearSelection,isLoading:Q,showEdit:!1}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"Recent Security Events"})]})}),e.jsx(a,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(u,{children:[e.jsx(h,{children:e.jsxs(p,{children:[e.jsx(y,{className:"w-12",children:e.jsx(w,{checked:W.length>0&&J.selectedCount===W.length,onCheckedChange:()=>J.toggleSelectAll(W,e=>e.id),"aria-label":"Select all security events"})}),e.jsx(y,{children:"Time"}),e.jsx(y,{children:"Type"}),e.jsx(y,{children:"Severity"}),e.jsx(y,{children:"Description"}),e.jsx(y,{children:"User/IP"}),e.jsx(y,{children:"Action Taken"})]})}),e.jsx(j,{children:W.map(s=>e.jsxs(p,{className:J.isSelected(s.id)?"bg-blue-50":"",children:[e.jsx(g,{children:e.jsx(w,{checked:J.isSelected(s.id),onCheckedChange:()=>J.toggleItem(s.id),"aria-label":`Select security event ${s.id}`})}),e.jsx(g,{className:"font-mono text-sm",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:new Date(s.timestamp).toLocaleString()})]})}),e.jsx(g,{children:e.jsx(x,{variant:"outline",children:s.type.replace("_"," ")})}),e.jsx(g,{children:e.jsx(x,{className:Y(s.severity),children:s.severity.toUpperCase()})}),e.jsx(g,{children:s.description}),e.jsxs(g,{className:"font-mono text-sm",children:[s.user&&e.jsx("div",{children:s.user}),s.ip_address&&e.jsx("div",{className:"text-gray-500",children:s.ip_address})]}),e.jsx(g,{children:s.action_taken||"No action taken"})]},s.id))})]})})})]}),e.jsx(N,{isOpen:G,onClose:()=>z(!1),onConfirm:async()=>{X(!0);try{const e=J.getSelectedData(W,e=>e.id),s=e.map(e=>e.id),t=W.filter(e=>!s.includes(e.id));B(t),H({title:"Success",description:`Deleted ${e.length} security events successfully`}),z(!1),J.clearSelection()}catch(e){console.error("Error in batch delete:",e),H({title:"Error",description:`Failed to delete security events: ${e}`,variant:"destructive"})}finally{X(!1)}},selectedCount:J.selectedCount,isLoading:Q,itemName:"security events",selectedItems:J.getSelectedData(W,e=>e.id).map(e=>({id:e.id,name:`${e.type} - ${e.severity.toUpperCase()} - ${e.description.substring(0,50)}...`}))})]}):e.jsx(b,{feature:"Security Settings",requiredRole:"Administrator"})};export{R as default};
